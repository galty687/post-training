<!DOCTYPE html><!--LtZ6IzbtjghsVdbdStESg--><html lang="zh-CN" class="__variable_51740a __variable_3c557b"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/bb3ef058b751a6ad-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/edef1a271f97a8ec-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/185b0b411056c01b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/62a6e77bcc5afb05.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/4cd23781d18a52d3.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-a61f7f8836a0480d.js"/><script src="/_next/static/chunks/6ee9f5d1-587662d01a07af8c.js" async=""></script><script src="/_next/static/chunks/4977-b2b53feb1c871da7.js" async=""></script><script src="/_next/static/chunks/main-app-9a763735f42e0f15.js" async=""></script><script src="/_next/static/chunks/1716-ed56095c0e3eb43d.js" async=""></script><script src="/_next/static/chunks/6098-1ad6a5cc0dfa14ba.js" async=""></script><script src="/_next/static/chunks/app/layout-9d0d0c8d6a45b02d.js" async=""></script><script src="/_next/static/chunks/4285-64b9e8f08c1e911d.js" async=""></script><script src="/_next/static/chunks/1698-20472d0927059867.js" async=""></script><script src="/_next/static/chunks/7997-9f155fcb121a084c.js" async=""></script><script src="/_next/static/chunks/795-ed3635716c096e23.js" async=""></script><script src="/_next/static/chunks/app/docs/layout-bc08591310048441.js" async=""></script><script src="/_next/static/chunks/942c9eea-01405fae79cb4292.js" async=""></script><script src="/_next/static/chunks/8697-8ff18c4921047cfe.js" async=""></script><script src="/_next/static/chunks/6249-ace54a767b378723.js" async=""></script><script src="/_next/static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-6PZFJCKFSJ" as="script"/><meta name="next-size-adjust" content=""/><title>2.1 指令数据集构建方法 | LLM 后训练课程</title><meta name="description" content="从 Self-Instruct 到 MAGPIE 的指令数据集技术演进，数据质量控制方法，数据混合策略"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="flex min-h-screen flex-col"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="bg-fd-secondary/50 p-3 empty:hidden"></div><header id="nd-subnav" class="fixed top-(--fd-banner-height) left-0 right-(--removed-body-scroll-bar-size,0) z-30 flex items-center ps-4 pe-2.5 border-b transition-colors backdrop-blur-sm bg-fd-background/80 h-(--fd-nav-height) on-root:[--fd-nav-height:56px] md:on-root:[--fd-nav-height:0px] md:hidden"><a class="inline-flex items-center gap-2.5 font-semibold" href="/">LLM 后训练实践</a><div class="flex-1"></div><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground [&amp;_svg]:size-4.5 p-2" data-search="" aria-label="Open Search"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></button><button class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground [&amp;_svg]:size-4.5 p-2" aria-label="Open Sidebar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg></button></header><main id="nd-docs-layout" class="flex flex-1 flex-col pt-(--fd-nav-height) transition-[padding] fd-default-layout mx-(--fd-layout-offset) md:[&amp;_#nd-page_article]:pt-12 xl:[--fd-toc-width:286px] xl:[&amp;_#nd-page_article]:px-8 md:[--fd-sidebar-width:268px] lg:[--fd-sidebar-width:286px]" style="padding-inline-start:var(--fd-sidebar-width)"><div class="fixed flex shadow-lg transition-opacity rounded-xl p-0.5 border bg-fd-muted text-fd-muted-foreground z-10 max-md:hidden xl:start-4 max-xl:end-4 pointer-events-none opacity-0" style="top:calc(var(--fd-banner-height) + var(--fd-tocnav-height) + var(--spacing) * 4)"><button type="button" aria-label="Collapse Sidebar" data-collapsed="false" class="inline-flex items-center justify-center text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground p-1.5 [&amp;_svg]:size-4.5 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg></button><button type="button" class="inline-flex items-center justify-center text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground p-1.5 [&amp;_svg]:size-4.5 rounded-lg" data-search="" aria-label="Open Search"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></button></div><aside id="nd-sidebar" data-collapsed="false" class="fixed left-0 rtl:left-auto rtl:right-(--removed-body-scroll-bar-size,0) flex flex-col items-end top-(--fd-sidebar-top) bottom-(--fd-sidebar-margin) z-20 bg-fd-card text-sm border-e transition-[top,opacity,translate,width] duration-200 max-md:hidden *:w-(--fd-sidebar-width)" style="--fd-sidebar-offset:calc(16px - 100%);--fd-sidebar-margin:0px;--fd-sidebar-top:calc(var(--fd-banner-height) + var(--fd-nav-height) + var(--fd-sidebar-margin));width:calc(var(--spacing) + var(--fd-sidebar-width) + var(--fd-layout-offset))"><div class="flex flex-col gap-3 p-4 pb-2"><div class="flex"><a class="inline-flex text-[15px] items-center gap-2.5 font-medium me-auto" href="/">LLM 后训练实践</a><button type="button" aria-label="Collapse Sidebar" data-collapsed="false" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground p-1.5 [&amp;_svg]:size-4.5 mb-auto text-fd-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg></button></div><button type="button" data-search-full="" class="inline-flex items-center gap-2 rounded-lg border bg-fd-secondary/50 p-1.5 ps-2 text-sm text-fd-muted-foreground transition-colors hover:bg-fd-accent hover:text-fd-accent-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-4"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>Search<div class="ms-auto inline-flex gap-0.5"><kbd class="rounded-md border bg-fd-background px-1.5">⌘</kbd><kbd class="rounded-md border bg-fd-background px-1.5">K</kbd></div></button></div><div dir="ltr" class="overflow-hidden h-full" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" class="size-full rounded-[inherit] p-4 overscroll-contain" style="overflow-x:hidden;overflow-y:hidden;--sidebar-item-offset:calc(var(--spacing) * 2);mask-image:linear-gradient(to bottom, transparent, white 12px, white calc(100% - 12px), transparent)"><div style="min-width:100%;display:table"><a class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none mb-4" data-active="false" href="/docs/">课程内容</a><p class="inline-flex items-center gap-2 mb-1.5 px-2 ps-(--sidebar-item-offset) empty:mb-0 [&amp;_svg]:size-4 [&amp;_svg]:shrink-0">课程内容</p><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/">课程总览</a><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/grading/">评分标准</a><p class="inline-flex items-center gap-2 mb-1.5 px-2 ps-(--sidebar-item-offset) empty:mb-0 [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 mt-6">授课</p><div data-state="closed"><button type="button" aria-controls="radix-_R_5kqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第1课：后训练概述与SFT基础<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_5kqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div><div data-state="open"><button type="button" aria-controls="radix-_R_6kqd5ulb_" aria-expanded="true" data-state="open" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第2课：SFT进阶<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="open" id="radix-_R_6kqd5ulb_" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/lecture-2/">第2课：SFT 进阶——数据工程与指令微调深入</a><a data-active="true" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 bg-fd-primary/10 text-fd-primary" href="/docs/lecture-2/instruction-datasets/">2.1 指令数据集构建方法</a><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/lecture-2/sft-hyperparameters/">2.2 SFT 超参数实践指南</a><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/lecture-2/llm-as-judge/">2.3 LLM-as-Judge 评估方法</a><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/lecture-2/papers/">第2课 推荐论文</a><a data-active="false" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none" href="/docs/lecture-2/lab/">实验2：构建领域定制 SFT 模型并系统评估</a></div></div><div data-state="closed"><button type="button" aria-controls="radix-_R_7kqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第3课：偏好对齐DPO<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_7kqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div><div data-state="closed"><button type="button" aria-controls="radix-_R_8kqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第4课：RLHF与GRPO<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_8kqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div><div data-state="closed"><button type="button" aria-controls="radix-_R_9kqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第5课：压缩部署与扩展<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_9kqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div><div data-state="closed"><button type="button" aria-controls="radix-_R_akqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">第6课：项目报告与总结<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_akqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div><p class="inline-flex items-center gap-2 mb-1.5 px-2 ps-(--sidebar-item-offset) empty:mb-0 [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 mt-6">资源</p><div data-state="closed"><button type="button" aria-controls="radix-_R_ckqd5ulb_" aria-expanded="false" data-state="closed" class="relative flex flex-row items-center gap-2 rounded-lg p-2 ps-(--sidebar-item-offset) text-start text-fd-muted-foreground [overflow-wrap:anywhere] [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 transition-colors hover:bg-fd-accent/50 hover:text-fd-accent-foreground/80 hover:transition-none w-full">课程资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide ms-auto transition-transform -rotate-90" data-icon="true"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_ckqd5ulb_" hidden="" class="overflow-hidden relative before:content-[&#x27;&#x27;] before:absolute before:w-px before:inset-y-1 before:bg-fd-border before:start-2.5 **:data-[active=true]:before:content-[&#x27;&#x27;] **:data-[active=true]:before:bg-fd-primary **:data-[active=true]:before:absolute **:data-[active=true]:before:w-px **:data-[active=true]:before:inset-y-2.5 **:data-[active=true]:before:start-2.5" style="--sidebar-item-offset:calc(var(--spacing) * 6)"></div></div></div></div></div><div class="flex flex-col border-t p-4 pt-2"><div class="flex text-fd-muted-foreground items-center empty:hidden"><button class="inline-flex items-center rounded-full border ms-auto p-0" aria-label="Toggle Theme" data-theme-toggle=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-6.5 rounded-full p-1.5 text-fd-muted-foreground"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-6.5 rounded-full p-1.5 text-fd-muted-foreground"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button></div></div></aside><div id="nd-page" class="flex flex-1 w-full mx-auto max-w-(--fd-page-width) pt-(--fd-tocnav-height) pe-(--fd-toc-width)"><header id="nd-tocnav" class="fixed pr-(--removed-body-scroll-bar-size,0) z-10 border-b backdrop-blur-sm transition-colors xl:hidden max-xl:on-root:[--fd-tocnav-height:40px] bg-fd-background/80" style="top:calc(var(--fd-banner-height) + var(--fd-nav-height));inset-inline-start:calc(var(--fd-sidebar-width) + var(--fd-layout-offset));inset-inline-end:0" data-state="closed"><button type="button" aria-controls="radix-_R_anpft5ulb_" aria-expanded="false" data-state="closed" class="flex w-full h-(--fd-tocnav-height) items-center text-sm text-fd-muted-foreground gap-2.5 px-4 py-2.5 text-start focus-visible:outline-none [&amp;_svg]:size-4 md:px-6"><svg role="progressbar" viewBox="0 0 24 24" aria-valuenow="0" aria-valuemin="0" aria-valuemax="1" class="shrink-0"><circle cx="12" cy="12" r="11" fill="none" stroke-width="2" class="stroke-current/25"></circle><circle cx="12" cy="12" r="11" fill="none" stroke-width="2" stroke="currentColor" stroke-dasharray="69.11503837897544" stroke-dashoffset="69.11503837897544" stroke-linecap="round" transform="rotate(-90 12 12)" class="transition-all"></circle></svg><span class="grid flex-1 *:my-auto *:row-start-1 *:col-start-1"><span class="truncate transition-all">2.1 指令数据集构建方法</span><span class="truncate transition-all opacity-0 translate-y-full pointer-events-none"></span></span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide shrink-0 transition-transform mx-0.5"><path d="m6 9 6 6 6-6"></path></svg></button><div data-state="closed" id="radix-_R_anpft5ulb_" hidden="" data-toc-popover="" class="overflow-hidden flex flex-col px-4 max-h-[50vh] md:px-6"></div></header><article class="flex min-w-0 w-full flex-col gap-4 pt-8 px-4 md:px-6 md:mx-auto"><div class="flex items-center gap-1.5 text-sm text-fd-muted-foreground"><span class="truncate text-fd-primary font-medium">第2课：SFT进阶</span></div><h1 class="text-[1.75em] font-semibold">2.1 指令数据集构建方法</h1><p class="mb-8 text-lg text-fd-muted-foreground">从 Self-Instruct 到 MAGPIE 的指令数据集技术演进，数据质量控制方法，数据混合策略</p><div class="prose flex-1"><h2 class="flex scroll-m-28 flex-row items-center gap-2" id="指令数据集的演进"><a data-card="" href="#指令数据集的演进" class="peer">指令数据集的演进</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>指令数据集是 SFT 的核心。过去三年，指令数据集的构建方法经历了快速演进——从手工标注到完全自动化合成。</p>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="发展时间线"><a data-card="" href="#发展时间线" class="peer">发展时间线</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div style="text-align:center;margin:24px 0;padding:20px;background:#FEFCFB;border:1px solid #E8E0DD;border-radius:10px;overflow-x:auto"></div>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="self-instruct指令数据合成的开创"><a data-card="" href="#self-instruct指令数据合成的开创" class="peer">Self-Instruct：指令数据合成的开创</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p><a href="https://arxiv.org/abs/2212.10560" rel="noreferrer noopener" target="_blank">Self-Instruct</a>（Wang 等，2023）是第一个系统性的指令数据自动生成方法。</p>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="核心流程"><a data-card="" href="#核心流程" class="peer">核心流程</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="fd-steps"><div class="fd-step"><h3 class="flex scroll-m-28 flex-row items-center gap-2" id="准备种子任务"><a data-card="" href="#准备种子任务" class="peer">准备种子任务</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3><p>人工编写 <strong>175 条</strong>种子任务，涵盖不同类型（生成、分类、问答等）。每条包含指令、输入（可选）和输出。</p></div><div class="fd-step"><h3 class="flex scroll-m-28 flex-row items-center gap-2" id="指令生成"><a data-card="" href="#指令生成" class="peer">指令生成</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3><p>从种子池中随机采样 8 条指令作为 in-context 示例，提示 GPT-3 生成<strong>新指令</strong>。</p></div><div class="fd-step"><h3 class="flex scroll-m-28 flex-row items-center gap-2" id="质量过滤"><a data-card="" href="#质量过滤" class="peer">质量过滤</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3><ul>
<li>去除与已有指令过于相似的（ROUGE-L &gt; 0.7）</li>
<li>去除以特定黑名单短语开头的（如&quot;Write a program...&quot;过于简单）</li>
<li>去除过长或过短的指令</li>
</ul></div><div class="fd-step"><h3 class="flex scroll-m-28 flex-row items-center gap-2" id="回复生成"><a data-card="" href="#回复生成" class="peer">回复生成</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3><p>对过滤后的指令，使用 GPT-3 生成对应回复，形成完整的（指令，回复）对。</p></div></div>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="局限性"><a data-card="" href="#局限性" class="peer">局限性</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>局限</th><th>说明</th></tr></thead><tbody><tr><td>依赖种子数据</td><td>生成质量受 175 条种子任务的多样性限制</td></tr><tr><td>API 成本</td><td>需要大量 GPT-3 API 调用</td></tr><tr><td>质量上限</td><td>生成的数据质量受限于 GPT-3 的能力</td></tr><tr><td>多轮对话弱</td><td>主要生成单轮指令-回复对</td></tr></tbody></table></div>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="alpaca快速跟进与规模化"><a data-card="" href="#alpaca快速跟进与规模化" class="peer">Alpaca：快速跟进与规模化</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p><a href="https://github.com/tatsu-lab/stanford_alpaca" rel="noreferrer noopener" target="_blank">Stanford Alpaca</a> 在 Self-Instruct 基础上做了实用改进：</p>
<ul>
<li>使用 <strong>GPT-3.5-Turbo</strong> 替代 GPT-3，质量更高、成本更低</li>
<li>生成了 <strong>52K 条</strong>指令数据</li>
<li>用这些数据微调 LLaMA-7B，总成本不到 600 美元</li>
<li>效果令人惊喜：7B 模型展现出接近 GPT-3.5 的对话能力</li>
</ul>
<div class="flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md" style="--callout-color:var(--color-fd-info, var(--color-fd-muted))"><div role="none" class="w-0.5 bg-(--callout-color)/50 rounded-sm"></div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div class="flex flex-col gap-2 min-w-0 flex-1"><div class="text-fd-muted-foreground prose-no-margin empty:hidden"><p>Alpaca 的意义不仅在于技术，更在于它证明了一个重要观点：<strong>高质量的指令数据可以让小模型释放出惊人的能力</strong>。这催生了整个开源 SFT 社区的繁荣。</p></div></div></div>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="ultrachat高质量多轮对话"><a data-card="" href="#ultrachat高质量多轮对话" class="peer">UltraChat：高质量多轮对话</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p><a href="https://arxiv.org/abs/2305.14233" rel="noreferrer noopener" target="_blank">UltraChat</a>（Ding 等，2023）将指令数据从单轮扩展到<strong>多轮对话</strong>：</p>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="数据构建策略"><a data-card="" href="#数据构建策略" class="peer">数据构建策略</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>UltraChat 通过模拟真实对话场景来构建数据：</p>
<ol>
<li><strong>话题种子</strong>：从三大类别出发——关于世界的问题、创作与写作、协助完成任务</li>
<li><strong>多轮模拟</strong>：使用两个 ChatGPT 实例分别扮演用户和助手，进行多轮对话</li>
<li><strong>质量控制</strong>：过滤长度异常、重复率高的对话</li>
</ol>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="数据规模"><a data-card="" href="#数据规模" class="peer">数据规模</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>版本</th><th>数据量</th><th>说明</th></tr></thead><tbody><tr><td>UltraChat</td><td>1.5M 条对话</td><td>原始版本</td></tr><tr><td>UltraChat-200K</td><td>200K 条对话</td><td>清洗版，去除低质量样本</td></tr></tbody></table></div>
<p>UltraChat-200K 是目前最常用的 SFT 数据集之一，也是本课程第 1 课实验使用的数据集。</p>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="magpie无种子数据合成"><a data-card="" href="#magpie无种子数据合成" class="peer">MAGPIE：无种子数据合成</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p><a href="https://arxiv.org/abs/2406.08464" rel="noreferrer noopener" target="_blank">MAGPIE</a>（Xu 等，ICLR 2025）代表了指令数据合成的最新前沿。</p>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="核心创新"><a data-card="" href="#核心创新" class="peer">核心创新</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>MAGPIE 的关键洞察：<strong>已对齐的 LLM 在看到聊天模板的用户消息前缀时，会自动补全出一条合理的指令</strong>。</p>
<figure dir="ltr" class="my-4 bg-fd-card rounded-xl shiki relative border shadow-sm outline-none not-prose overflow-hidden text-sm shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><div class="empty:hidden absolute top-2 right-2 z-2 backdrop-blur-lg rounded-lg text-fd-muted-foreground"><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring p-1 [&amp;_svg]:size-4 hover:text-fd-accent-foreground data-[checked]:text-fd-accent-foreground" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></button></div><div class="text-[13px] py-3.5 overflow-auto max-h-[600px] fd-scroll-container" style="--padding-right:calc(var(--spacing) * 8)"><pre class="min-w-full w-max *:flex *:flex-col"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># MAGPIE 的核心思路（伪代码）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 1. 仅输入 ChatML 模板的用户消息前缀</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> &quot;&lt;|im_start|&gt;user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 2. 让对齐模型（如 Qwen3-32B Instruct）自动补全</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">generated_instruction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> model.generate(prompt)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 输出示例：&quot;解释黑洞是如何形成的，并举一个具体例子&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 3. 将生成的指令重新输入模型，获得回复</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">full_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;&lt;|im_start|&gt;user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\n{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">generated_instruction</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&lt;|im_end|&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&lt;|im_start|&gt;assistant</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> model.generate(full_prompt)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 4. 形成完整的 (指令, 回复) 对</span></span></code></pre></div></figure>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="与传统方法的对比"><a data-card="" href="#与传统方法的对比" class="peer">与传统方法的对比</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>特性</th><th>Self-Instruct</th><th>Alpaca</th><th>MAGPIE</th></tr></thead><tbody><tr><td>种子数据</td><td>175 条</td><td>175 条（继承）</td><td><strong>无需</strong></td></tr><tr><td>生成模型</td><td>GPT-3</td><td>GPT-3.5</td><td>任意对齐 LLM</td></tr><tr><td>多轮能力</td><td>弱</td><td>弱</td><td>支持</td></tr><tr><td>指令多样性</td><td>受种子限制</td><td>受种子限制</td><td><strong>来自模型自身分布</strong></td></tr><tr><td>成本</td><td>API 调用</td><td>API 调用</td><td><strong>本地推理</strong></td></tr><tr><td>数据质量</td><td>中等</td><td>中等</td><td><strong>高</strong>（来自强模型）</td></tr></tbody></table></div>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="magpie-的多样性来源"><a data-card="" href="#magpie-的多样性来源" class="peer">MAGPIE 的多样性来源</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>MAGPIE 的指令多样性来自对齐模型自身的概率分布。不同的随机种子和 temperature 设置会采样出覆盖面广泛的指令类型：</p>
<figure dir="ltr" class="my-4 bg-fd-card rounded-xl shiki relative border shadow-sm outline-none not-prose overflow-hidden text-sm shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><div class="empty:hidden absolute top-2 right-2 z-2 backdrop-blur-lg rounded-lg text-fd-muted-foreground"><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring p-1 [&amp;_svg]:size-4 hover:text-fd-accent-foreground data-[checked]:text-fd-accent-foreground" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></button></div><div class="text-[13px] py-3.5 overflow-auto max-h-[600px] fd-scroll-container" style="--padding-right:calc(var(--spacing) * 8)"><pre class="min-w-full w-max *:flex *:flex-col"><code><span class="line"><span>temperature=0.7 → 常规指令（问答、解释、摘要）</span></span>
<span class="line"><span>temperature=1.0 → 创意指令（写作、角色扮演）</span></span>
<span class="line"><span>temperature=1.2 → 不常见指令（冷门话题、跨领域）</span></span></code></pre></div></figure>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="数据质量控制"><a data-card="" href="#数据质量控制" class="peer">数据质量控制</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="去重deduplication"><a data-card="" href="#去重deduplication" class="peer">去重（Deduplication）</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>重复或近似重复的训练数据会导致模型过拟合到特定模式。去重方法：</p>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>方法</th><th>原理</th><th>优势</th><th>成本</th></tr></thead><tbody><tr><td><strong>精确去重</strong></td><td>完全相同的文本</td><td>实现简单</td><td>低</td></tr><tr><td><strong>n-gram 去重</strong></td><td>Jaccard 相似度 &gt; 阈值</td><td>捕获近似重复</td><td>中</td></tr><tr><td><strong>嵌入去重</strong></td><td>向量余弦相似度 &gt; 阈值</td><td>捕获语义重复</td><td>高</td></tr><tr><td><strong>MinHash LSH</strong></td><td>近似最近邻搜索</td><td>大规模高效</td><td>中</td></tr></tbody></table></div>
<figure dir="ltr" class="my-4 bg-fd-card rounded-xl shiki relative border shadow-sm outline-none not-prose overflow-hidden text-sm shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><div class="empty:hidden absolute top-2 right-2 z-2 backdrop-blur-lg rounded-lg text-fd-muted-foreground"><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring p-1 [&amp;_svg]:size-4 hover:text-fd-accent-foreground data-[checked]:text-fd-accent-foreground" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></button></div><div class="text-[13px] py-3.5 overflow-auto max-h-[600px] fd-scroll-container" style="--padding-right:calc(var(--spacing) * 8)"><pre class="min-w-full w-max *:flex *:flex-col"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 基于 n-gram 的简单去重示例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> collections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Counter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> compute_ngram_overlap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(text1, text2, n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &quot;&quot;&quot;计算两段文本的 n-gram Jaccard 相似度&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ngrams1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[text1.split()[i:] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(n)]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ngrams2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[text2.split()[i:] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(n)]))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams2:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    intersection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    union </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ngrams2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(intersection) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(union)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 标记相似度 &gt; 0.7 的样本对为近似重复</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SIMILARITY_THRESHOLD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0.7</span></span></code></pre></div></figure>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="难度分级difficulty-grading"><a data-card="" href="#难度分级difficulty-grading" class="peer">难度分级（Difficulty Grading）</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>并非所有难度的数据对 SFT 同等有效。研究表明应优先选择<strong>中等难度</strong>样本：</p>
<ul>
<li><strong>太简单的数据</strong>：模型已经会做，学不到新东西（如&quot;1+1=?&quot;）</li>
<li><strong>太难的数据</strong>：超出模型能力范围，训练信号噪声大</li>
<li><strong>中等难度数据</strong>：在模型能力边界处，学习效率最高</li>
</ul>
<p><strong>IFD（Instruction-Following Difficulty）</strong> 指标用于评估样本难度：</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>IFD</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mtext>Loss</mtext><mtext>conditioned</mtext></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mtext>Loss</mtext><mtext>unconditional</mtext></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{IFD}(x, y) = \frac{\text{Loss}_{\text{conditioned}}(y|x)}{\text{Loss}_{\text{unconditional}}(y)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">IFD</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Loss</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">unconditional</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Loss</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">conditioned</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<ul>
<li>IFD 值高：指令对回复的影响大，即模型需要指令才能生成该回复（较难）</li>
<li>IFD 值低：即使没有指令，模型也能生成类似回复（较简单）</li>
</ul>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="去污染decontamination"><a data-card="" href="#去污染decontamination" class="peer">去污染（Decontamination）</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md" style="--callout-color:var(--color-fd-error, var(--color-fd-muted))"><div role="none" class="w-0.5 bg-(--callout-color)/50 rounded-sm"></div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card"><circle cx="12" cy="12" r="10"></circle><path d="m15 9-6 6"></path><path d="m9 9 6 6"></path></svg><div class="flex flex-col gap-2 min-w-0 flex-1"><div class="text-fd-muted-foreground prose-no-margin empty:hidden"><p><strong>极其重要</strong>：训练数据<strong>绝对不能</strong>包含评估基准的测试集内容。否则评估结果将毫无意义。这就是&quot;数据泄露&quot;（data contamination）问题。</p></div></div></div>
<p>去污染步骤：</p>
<ol>
<li>收集所有常用评估基准的测试集：GSM8K、MMLU、HumanEval、IFEval 等</li>
<li>对训练数据中的每条样本，检测与测试集的 n-gram 重叠</li>
<li>移除重叠度超过阈值的训练样本</li>
</ol>
<figure dir="ltr" class="my-4 bg-fd-card rounded-xl shiki relative border shadow-sm outline-none not-prose overflow-hidden text-sm shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><div class="empty:hidden absolute top-2 right-2 z-2 backdrop-blur-lg rounded-lg text-fd-muted-foreground"><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring p-1 [&amp;_svg]:size-4 hover:text-fd-accent-foreground data-[checked]:text-fd-accent-foreground" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></button></div><div class="text-[13px] py-3.5 overflow-auto max-h-[600px] fd-scroll-container" style="--padding-right:calc(var(--spacing) * 8)"><pre class="min-w-full w-max *:flex *:flex-col"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 去污染检查示例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> check_contamination</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(train_sample, test_samples, n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, threshold</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &quot;&quot;&quot;检查训练样本是否与测试集存在 n-gram 重叠&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    train_ngrams </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extract_ngrams(train_sample, n)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test_sample </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test_samples:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        test_ngrams </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extract_ngrams(test_sample, n)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        overlap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(train_ngrams </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test_ngrams) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(test_ngrams), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> overlap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> threshold:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  # 污染！应移除</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> False</span></span></code></pre></div></figure>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="数据混合策略"><a data-card="" href="#数据混合策略" class="peer">数据混合策略</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="为什么需要混合"><a data-card="" href="#为什么需要混合" class="peer">为什么需要混合</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>单一来源的数据会导致模型<strong>能力偏科</strong>：</p>
<ul>
<li>只用对话数据 → 推理能力弱</li>
<li>只用代码数据 → 通用对话差</li>
<li>只用安全数据 → 过度拒绝</li>
</ul>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="tülu-3-的数据混合实践"><a data-card="" href="#tülu-3-的数据混合实践" class="peer">Tülu 3 的数据混合实践</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<p>Tülu 3 通过系统性消融实验确定了最优数据配比：</p>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>数据类别</th><th>代表数据集</th><th>大致占比</th><th>作用</th></tr></thead><tbody><tr><td>通用对话</td><td>UltraChat, ShareGPT</td><td>~30%</td><td>基础对话能力</td></tr><tr><td>指令跟随</td><td>IFEval 训练数据</td><td>~15%</td><td>精确格式遵循</td></tr><tr><td>数学推理</td><td>GSM8K, MATH 训练集</td><td>~15%</td><td>数学推理能力</td></tr><tr><td>代码生成</td><td>Code-Feedback</td><td>~15%</td><td>编程能力</td></tr><tr><td>安全数据</td><td>安全相关指令</td><td>~10%</td><td>安全对齐</td></tr><tr><td>知识问答</td><td>FLAN, 百科类</td><td>~10%</td><td>知识广度</td></tr><tr><td>创意写作</td><td>写作类指令</td><td>~5%</td><td>创意生成</td></tr></tbody></table></div>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="混合原则"><a data-card="" href="#混合原则" class="peer">混合原则</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<div class="flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md" style="--callout-color:var(--color-fd-info, var(--color-fd-muted))"><div role="none" class="w-0.5 bg-(--callout-color)/50 rounded-sm"></div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div class="flex flex-col gap-2 min-w-0 flex-1"><div class="text-fd-muted-foreground prose-no-margin empty:hidden"><p>Tülu 3 的核心发现：<strong>没有一个固定的最优配比</strong>——最优配比取决于你希望模型擅长什么。但以下原则是通用的：</p><ol>
<li>确保<strong>所有目标能力</strong>都有代表性数据</li>
<li><strong>薄弱能力</strong>可适当增加数据占比</li>
<li>安全数据不能太少（否则不安全），也不能太多（否则过度拒绝）</li>
<li>始终通过<strong>验证集实验</strong>确认配比效果</li>
</ol></div></div></div>
<h3 class="flex scroll-m-28 flex-row items-center gap-2" id="数据配比实验方法"><a data-card="" href="#数据配比实验方法" class="peer">数据配比实验方法</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h3>
<figure dir="ltr" class="my-4 bg-fd-card rounded-xl shiki relative border shadow-sm outline-none not-prose overflow-hidden text-sm shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><div class="empty:hidden absolute top-2 right-2 z-2 backdrop-blur-lg rounded-lg text-fd-muted-foreground"><button type="button" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring p-1 [&amp;_svg]:size-4 hover:text-fd-accent-foreground data-[checked]:text-fd-accent-foreground" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></button></div><div class="text-[13px] py-3.5 overflow-auto max-h-[600px] fd-scroll-container" style="--padding-right:calc(var(--spacing) * 8)"><pre class="min-w-full w-max *:flex *:flex-col"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 数据混合实验框架</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mix_configs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &quot;config_a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;general&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;math&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;safety&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &quot;config_b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;general&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;math&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;safety&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">},</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &quot;config_c&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;general&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;math&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&quot;safety&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 对每种配比：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 1. 按比例采样构建训练集</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 2. 训练模型（固定其他超参数）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 3. 在多个基准上评估（GSM8K、HumanEval、MT-Bench、安全测试）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 4. 选择综合表现最优的配比</span></span></code></pre></div></figure>
<hr/>
<h2 class="flex scroll-m-28 flex-row items-center gap-2" id="本节小结"><a data-card="" href="#本节小结" class="peer">本节小结</a><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100" aria-label="Link to section"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>方法</th><th>年份</th><th>核心思想</th><th>数据量</th></tr></thead><tbody><tr><td>Self-Instruct</td><td>2022</td><td>种子任务 + LLM 扩展</td><td>52K</td></tr><tr><td>Alpaca</td><td>2023</td><td>Self-Instruct + GPT-3.5</td><td>52K</td></tr><tr><td>UltraChat</td><td>2023</td><td>双模型模拟多轮对话</td><td>1.5M → 200K（清洗）</td></tr><tr><td>MAGPIE</td><td>2024</td><td>利用对齐模型自动补全，无需种子</td><td>可无限扩展</td></tr></tbody></table></div>
<div class="relative overflow-auto prose-no-margin my-6"><table><thead><tr><th>质量控制</th><th>方法</th><th>重要性</th></tr></thead><tbody><tr><td>去重</td><td>n-gram / 嵌入相似度</td><td>高——避免过拟合</td></tr><tr><td>难度分级</td><td>IFD 等指标</td><td>中——提升学习效率</td></tr><tr><td>去污染</td><td>n-gram 匹配测试集</td><td><strong>极高</strong>——保证评估有效性</td></tr><tr><td>数据混合</td><td>消融实验确定配比</td><td>高——平衡多维能力</td></tr></tbody></table></div></div><div class="flex flex-row flex-wrap items-center justify-between gap-4 empty:hidden"></div><div class="@container grid gap-4 pb-6 grid-cols-2"><a class="flex flex-col gap-2 rounded-lg border p-4 text-sm transition-colors hover:bg-fd-accent/80 hover:text-fd-accent-foreground @max-lg:col-span-full" href="/docs/lecture-2/"><div class="inline-flex items-center gap-1.5 font-medium"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide -mx-1 size-4 shrink-0 rtl:rotate-180"><path d="m15 18-6-6 6-6"></path></svg><p>第2课：SFT 进阶——数据工程与指令微调深入</p></div><p class="text-fd-muted-foreground truncate">掌握指令数据集的构建与质量控制方法，理解数据混合策略，实践 LLM-as-Judge 系统化评估</p></a><a class="flex flex-col gap-2 rounded-lg border p-4 text-sm transition-colors hover:bg-fd-accent/80 hover:text-fd-accent-foreground @max-lg:col-span-full text-end" href="/docs/lecture-2/sft-hyperparameters/"><div class="inline-flex items-center gap-1.5 font-medium flex-row-reverse"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide -mx-1 size-4 shrink-0 rtl:rotate-180"><path d="m9 18 6-6-6-6"></path></svg><p>2.2 SFT 超参数实践指南</p></div><p class="text-fd-muted-foreground truncate">基于 Pareja 等（2024）的系统实验结果，掌握 SFT 核心超参数的选择方法和常见问题诊断</p></a></div></article><div id="nd-toc" class="fixed bottom-0 pt-12 pb-2 pr-(--removed-body-scroll-bar-size,0) max-xl:hidden" style="top:calc(var(--fd-banner-height) + var(--fd-nav-height));inset-inline-end:max(var(--fd-layout-offset), calc(50vw - var(--fd-sidebar-width)/2 - var(--fd-page-width)/2))"><div class="flex h-full w-(--fd-toc-width) max-w-full flex-col pe-4"><h3 class="inline-flex items-center gap-1.5 text-sm text-fd-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide size-4"><path d="M15 18H3"></path><path d="M17 6H3"></path><path d="M21 12H3"></path></svg>On this page</h3><div class="relative min-h-0 text-sm ms-px overflow-auto [scrollbar-width:none] [mask-image:linear-gradient(to_bottom,transparent,white_16px,white_calc(100%-16px),transparent)] py-3"><div role="none" class="absolute top-(--fd-top) h-(--fd-height) w-px bg-fd-primary transition-all"></div><div class="flex flex-col border-s border-fd-foreground/10"><a data-active="false" href="#指令数据集的演进" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">指令数据集的演进</a><a data-active="false" href="#发展时间线" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">发展时间线</a><a data-active="false" href="#self-instruct指令数据合成的开创" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">Self-Instruct：指令数据合成的开创</a><a data-active="false" href="#核心流程" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">核心流程</a><a data-active="false" href="#准备种子任务" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">准备种子任务</a><a data-active="false" href="#指令生成" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">指令生成</a><a data-active="false" href="#质量过滤" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">质量过滤</a><a data-active="false" href="#回复生成" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">回复生成</a><a data-active="false" href="#局限性" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">局限性</a><a data-active="false" href="#alpaca快速跟进与规模化" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">Alpaca：快速跟进与规模化</a><a data-active="false" href="#ultrachat高质量多轮对话" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">UltraChat：高质量多轮对话</a><a data-active="false" href="#数据构建策略" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">数据构建策略</a><a data-active="false" href="#数据规模" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">数据规模</a><a data-active="false" href="#magpie无种子数据合成" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">MAGPIE：无种子数据合成</a><a data-active="false" href="#核心创新" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">核心创新</a><a data-active="false" href="#与传统方法的对比" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">与传统方法的对比</a><a data-active="false" href="#magpie-的多样性来源" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">MAGPIE 的多样性来源</a><a data-active="false" href="#数据质量控制" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">数据质量控制</a><a data-active="false" href="#去重deduplication" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">去重（Deduplication）</a><a data-active="false" href="#难度分级difficulty-grading" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">难度分级（Difficulty Grading）</a><a data-active="false" href="#去污染decontamination" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">去污染（Decontamination）</a><a data-active="false" href="#数据混合策略" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">数据混合策略</a><a data-active="false" href="#为什么需要混合" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">为什么需要混合</a><a data-active="false" href="#tülu-3-的数据混合实践" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">Tülu 3 的数据混合实践</a><a data-active="false" href="#混合原则" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">混合原则</a><a data-active="false" href="#数据配比实验方法" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-6">数据配比实验方法</a><a data-active="false" href="#本节小结" class="prose py-1.5 text-sm text-fd-muted-foreground transition-colors [overflow-wrap:anywhere] first:pt-0 last:pb-0 data-[active=true]:text-fd-primary ps-3">本节小结</a></div></div></div></div></div><!--$--><!--/$--></main><script src="/_next/static/chunks/webpack-a61f7f8836a0480d.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[57921,[\"1716\",\"static/chunks/1716-ed56095c0e3eb43d.js\",\"6098\",\"static/chunks/6098-1ad6a5cc0dfa14ba.js\",\"7177\",\"static/chunks/app/layout-9d0d0c8d6a45b02d.js\"],\"\"]\n3:I[28295,[\"1716\",\"static/chunks/1716-ed56095c0e3eb43d.js\",\"6098\",\"static/chunks/6098-1ad6a5cc0dfa14ba.js\",\"7177\",\"static/chunks/app/layout-9d0d0c8d6a45b02d.js\"],\"RootProvider\"]\n4:I[1409,[],\"\"]\n5:I[1813,[],\"\"]\n6:I[58434,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"TreeContextProvider\"]\nb:I[10323,[],\"\"]\n:HL[\"/_next/static/media/bb3ef058b751a6ad-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/edef1a271f97a8ec-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/185b0b411056c01b.css\",\"style\"]\n:HL[\"/_next/static/css/62a6e77bcc5afb05.css\",\"style\"]\n:HL[\"/_next/static/css/4cd23781d18a52d3.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"LtZ6IzbtjghsVdbdStESg\",\"p\":\"\",\"c\":[\"\",\"docs\",\"lecture-2\",\"instruction-datasets\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"lecture-2/instruction-datasets\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/185b0b411056c01b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/62a6e77bcc5afb05.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4cd23781d18a52d3.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"zh-CN\",\"className\":\"__variable_51740a __variable_3c557b\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L2\",null,{\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-6PZFJCKFSJ\",\"strategy\":\"afterInteractive\"}],[\"$\",\"$L2\",null,{\"id\":\"google-analytics\",\"strategy\":\"afterInteractive\",\"children\":\"\\n            window.dataLayer = window.dataLayer || [];\\n            function gtag(){dataLayer.push(arguments);}\\n            gtag('js', new Date());\\n            gtag('config', 'G-6PZFJCKFSJ');\\n          \"}]]}],[\"$\",\"body\",null,{\"className\":\"flex min-h-screen flex-col\",\"children\":[\"$\",\"$L3\",null,{\"search\":{\"options\":{\"type\":\"static\"}},\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[\"docs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"tree\":{\"$id\":\"root\",\"name\":\"课程内容\",\"children\":[{\"$id\":\"#0\",\"type\":\"separator\",\"icon\":\"$undefined\",\"name\":\"课程内容\"},{\"$id\":\"index.mdx\",\"type\":\"page\",\"name\":\"课程总览\",\"description\":\"大语言模型后训练实践——北京大学软件与微电子学院研究生课程\",\"icon\":\"$undefined\",\"url\":\"/docs\",\"$ref\":{\"file\":\"index.mdx\"}},{\"$id\":\"grading.mdx\",\"type\":\"page\",\"name\":\"评分标准\",\"description\":\"课程考核方式、各项评分细则与评分标准详细说明\",\"icon\":\"$undefined\",\"url\":\"/docs/grading\",\"$ref\":{\"file\":\"grading.mdx\"}},{\"$id\":\"#3\",\"type\":\"separator\",\"icon\":\"$undefined\",\"name\":\"授课\"},{\"type\":\"folder\",\"name\":\"第1课：后训练概述与SFT基础\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-1/index.mdx\",\"type\":\"page\",\"name\":\"第1课：后训练概述与监督微调基础\",\"description\":\"理解后训练在 LLM 开发流程中的位置和核心方法体系，掌握 SFT 训练循环，配置 LoRA/QLoRA 进行参数高效训练\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1\",\"$ref\":{\"file\":\"lecture-1/index.mdx\"}},{\"$id\":\"lecture-1/post-training-overview.mdx\",\"type\":\"page\",\"name\":\"1.1 后训练的定义与基本流程\",\"description\":\"理解 LLM 开发的三阶段流程，掌握后训练的核心方法体系，了解 Tülu 3 和 Qwen3 的后训练实践\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/post-training-overview\",\"$ref\":{\"file\":\"lecture-1/post-training-overview.mdx\"}},{\"$id\":\"lecture-1/sft-core-concepts.mdx\",\"type\":\"page\",\"name\":\"1.2 监督微调核心概念\",\"description\":\"掌握 ChatML 和 Llama 聊天模板格式，理解掩码损失（Masked Loss）的原理，了解数据质量的重要性\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/sft-core-concepts\",\"$ref\":{\"file\":\"lecture-1/sft-core-concepts.mdx\"}},{\"$id\":\"lecture-1/parameter-efficient-ft.mdx\",\"type\":\"page\",\"name\":\"1.3 参数高效微调\",\"description\":\"掌握 LoRA 和 QLoRA 的原理与实践，理解参数高效微调的必要性和显存优化策略\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/parameter-efficient-ft\",\"$ref\":{\"file\":\"lecture-1/parameter-efficient-ft.mdx\"}},{\"$id\":\"lecture-1/evaluation-methods.mdx\",\"type\":\"page\",\"name\":\"1.4 模型评估方法\",\"description\":\"了解 LLM 后训练的主流评估方法：LLM-as-Judge、人类偏好排行榜、能力专项基准和安全评估\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/evaluation-methods\",\"$ref\":{\"file\":\"lecture-1/evaluation-methods.mdx\"}},{\"$id\":\"lecture-1/papers.mdx\",\"type\":\"page\",\"name\":\"第1课 推荐论文\",\"description\":\"第1课推荐阅读的 5 篇核心论文：Tülu 3、LoRA、QLoRA、LIMA、MAGPIE\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/papers\",\"$ref\":{\"file\":\"lecture-1/papers.mdx\"}},{\"$id\":\"lecture-1/lab.mdx\",\"type\":\"page\",\"name\":\"实验1：微调 Qwen3-1.7B 为指令跟随助手\",\"description\":\"使用 QLoRA 和 SFTTrainer 将 Qwen3-1.7B 基座模型微调为指令跟随助手的完整实验\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-1/lab\",\"$ref\":{\"file\":\"lecture-1/lab.mdx\"}}],\"$id\":\"lecture-1\",\"$ref\":{\"metaFile\":\"lecture-1/meta.json\"}},{\"type\":\"folder\",\"name\":\"第2课：SFT进阶\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-2/index.mdx\",\"type\":\"page\",\"name\":\"第2课：SFT 进阶——数据工程与指令微调深入\",\"description\":\"掌握指令数据集的构建与质量控制方法，理解数据混合策略，实践 LLM-as-Judge 系统化评估\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2\",\"$ref\":{\"file\":\"lecture-2/index.mdx\"}},{\"$id\":\"lecture-2/instruction-datasets.mdx\",\"type\":\"page\",\"name\":\"2.1 指令数据集构建方法\",\"description\":\"从 Self-Instruct 到 MAGPIE 的指令数据集技术演进，数据质量控制方法，数据混合策略\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2/instruction-datasets\",\"$ref\":{\"file\":\"lecture-2/instruction-datasets.mdx\"}},{\"$id\":\"lecture-2/sft-hyperparameters.mdx\",\"type\":\"page\",\"name\":\"2.2 SFT 超参数实践指南\",\"description\":\"基于 Pareja 等（2024）的系统实验结果，掌握 SFT 核心超参数的选择方法和常见问题诊断\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2/sft-hyperparameters\",\"$ref\":{\"file\":\"lecture-2/sft-hyperparameters.mdx\"}},{\"$id\":\"lecture-2/llm-as-judge.mdx\",\"type\":\"page\",\"name\":\"2.3 LLM-as-Judge 评估方法\",\"description\":\"深入理解 LLM-as-Judge 评估框架，掌握 MT-Bench 评判模板，了解位置偏差和评委模型选择\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2/llm-as-judge\",\"$ref\":{\"file\":\"lecture-2/llm-as-judge.mdx\"}},{\"$id\":\"lecture-2/papers.mdx\",\"type\":\"page\",\"name\":\"第2课 推荐论文\",\"description\":\"第2课推荐阅读的 5 篇核心论文：SFT 超参数指南、Self-Instruct、MT-Bench、UltraChat、Deita\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2/papers\",\"$ref\":{\"file\":\"lecture-2/papers.mdx\"}},{\"$id\":\"lecture-2/lab.mdx\",\"type\":\"page\",\"name\":\"实验2：构建领域定制 SFT 模型并系统评估\",\"description\":\"从数据分析到模型训练到 LLM-as-Judge 评估的完整指令微调实验，含消融实验\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-2/lab\",\"$ref\":{\"file\":\"lecture-2/lab.mdx\"}}],\"$id\":\"lecture-2\",\"$ref\":{\"metaFile\":\"lecture-2/meta.json\"}},{\"type\":\"folder\",\"name\":\"第3课：偏好对齐DPO\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-3/index.mdx\",\"type\":\"page\",\"name\":\"第3课：偏好对齐——DPO 及其变体\",\"description\":\"理解为什么仅靠 SFT 不足以实现对齐，从 RLHF 目标推导 DPO 损失函数，实现 DPO 训练，并对 DPO 与 SimPO 进行实证比较\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3\",\"$ref\":{\"file\":\"lecture-3/index.mdx\"}},{\"$id\":\"lecture-3/alignment-problem.mdx\",\"type\":\"page\",\"name\":\"3.1 对齐问题：为什么仅靠 SFT 不够\",\"description\":\"SFT 教会模型'说什么'，但未教会它'如何选择'。人类偏好本质上是比较性的，偏好优化直接捕获这一信号。\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/alignment-problem\",\"$ref\":{\"file\":\"lecture-3/alignment-problem.mdx\"}},{\"$id\":\"lecture-3/dpo-derivation.mdx\",\"type\":\"page\",\"name\":\"3.2 DPO 数学推导\",\"description\":\"从 RLHF 目标到 DPO 损失函数的完整四步推导，包括闭式最优策略、奖励重参数化和 Bradley-Terry 代入\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/dpo-derivation\",\"$ref\":{\"file\":\"lecture-3/dpo-derivation.mdx\"}},{\"$id\":\"lecture-3/dpo-variants.mdx\",\"type\":\"page\",\"name\":\"3.3 DPO 变体\",\"description\":\"SimPO、KTO、ORPO、IPO 等 DPO 变体的设计理念、数学公式与适用场景比较\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/dpo-variants\",\"$ref\":{\"file\":\"lecture-3/dpo-variants.mdx\"}},{\"$id\":\"lecture-3/practical-considerations.mdx\",\"type\":\"page\",\"name\":\"3.4 实践考量\",\"description\":\"在线 vs 离线 DPO、beta 参数敏感性分析、偏好数据质量、当前领域趋势\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/practical-considerations\",\"$ref\":{\"file\":\"lecture-3/practical-considerations.mdx\"}},{\"$id\":\"lecture-3/papers.mdx\",\"type\":\"page\",\"name\":\"第3课推荐论文\",\"description\":\"DPO、SimPO、KTO、DPO vs PPO 对比实验、DPO 综述等 5 篇核心论文\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/papers\",\"$ref\":{\"file\":\"lecture-3/papers.mdx\"}},{\"$id\":\"lecture-3/lab.mdx\",\"type\":\"page\",\"name\":\"第3课实验：DPO 对齐与 SimPO 对比\",\"description\":\"使用 DPO 对齐 SFT 模型，与 SimPO 进行实证对比，涵盖偏好数据探索、训练、评估的完整流程\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-3/lab\",\"$ref\":{\"file\":\"lecture-3/lab.mdx\"}}],\"$id\":\"lecture-3\",\"$ref\":{\"metaFile\":\"lecture-3/meta.json\"}},{\"type\":\"folder\",\"name\":\"第4课：RLHF与GRPO\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-4/index.mdx\",\"type\":\"page\",\"name\":\"第4课：RLHF 原理与推理强化学习（GRPO）\",\"description\":\"理解完整的 RLHF 流程，掌握 GRPO 算法，使用可验证奖励复现迷你 DeepSeek-R1-Zero 实验，观察推理能力的涌现\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4\",\"$ref\":{\"file\":\"lecture-4/index.mdx\"}},{\"$id\":\"lecture-4/rlhf-pipeline.mdx\",\"type\":\"page\",\"name\":\"4.1 经典 RLHF 流程\",\"description\":\"InstructGPT 三阶段流程、奖励模型训练、PPO 核心组件、四模型架构及常见不稳定性\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/rlhf-pipeline\",\"$ref\":{\"file\":\"lecture-4/rlhf-pipeline.mdx\"}},{\"$id\":\"lecture-4/grpo-reasoning.mdx\",\"type\":\"page\",\"name\":\"4.2 GRPO 与推理涌现\",\"description\":\"DeepSeek-R1-Zero 里程碑、GRPO 四步算法详解、RLVR 可验证奖励、DeepSeek-R1 完整流程\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/grpo-reasoning\",\"$ref\":{\"file\":\"lecture-4/grpo-reasoning.mdx\"}},{\"$id\":\"lecture-4/grpo-improvements.mdx\",\"type\":\"page\",\"name\":\"4.3 GRPO 改进与测试时计算\",\"description\":\"DAPO、Dr. GRPO、REINFORCE++ 等改进方法，以及测试时计算扩展的概念和与 o1/o3/R1 的连接\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/grpo-improvements\",\"$ref\":{\"file\":\"lecture-4/grpo-improvements.mdx\"}},{\"$id\":\"lecture-4/rlhf-engineering.mdx\",\"type\":\"page\",\"name\":\"4.4 RLHF 工程工具\",\"description\":\"TRL、OpenRLHF、veRL 等 RLHF/GRPO 训练工具的功能、架构和使用场景对比\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/rlhf-engineering\",\"$ref\":{\"file\":\"lecture-4/rlhf-engineering.mdx\"}},{\"$id\":\"lecture-4/papers.mdx\",\"type\":\"page\",\"name\":\"第4课推荐论文\",\"description\":\"InstructGPT、DeepSeek-R1、DeepSeekMath、Snell et al.、DAPO、Safe RLHF、Qwen3 等 7 篇核心论文\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/papers\",\"$ref\":{\"file\":\"lecture-4/papers.mdx\"}},{\"$id\":\"lecture-4/lab.mdx\",\"type\":\"page\",\"name\":\"第4课实验：迷你 DeepSeek-R1-Zero\",\"description\":\"使用 GRPO 训练 Qwen3-1.7B-Base 进行数学推理，观察推理能力的涌现过程，并与蒸馏模型和 Qwen3 思考模式对比\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-4/lab\",\"$ref\":{\"file\":\"lecture-4/lab.mdx\"}}],\"$id\":\"lecture-4\",\"$ref\":{\"metaFile\":\"lecture-4/meta.json\"}},{\"type\":\"folder\",\"name\":\"第5课：压缩部署与扩展\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-5/index.mdx\",\"type\":\"page\",\"name\":\"第5课：模型压缩、部署优化与能力扩展\",\"description\":\"掌握模型量化的原理与实践（INT8/INT4/GPTQ/AWQ），理解知识蒸馏在后训练中的角色，了解多模态和工具使用等能力扩展方法\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5\",\"$ref\":{\"file\":\"lecture-5/index.mdx\"}},{\"$id\":\"lecture-5/quantization.mdx\",\"type\":\"page\",\"name\":\"5.1 模型量化\",\"description\":\"深入理解模型量化的原理、主流 PTQ 方法（INT8/INT4/GPTQ/AWQ）与 QAT，掌握精度-速度-显存的权衡\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5/quantization\",\"$ref\":{\"file\":\"lecture-5/quantization.mdx\"}},{\"$id\":\"lecture-5/knowledge-distillation.mdx\",\"type\":\"page\",\"name\":\"5.2 知识蒸馏\",\"description\":\"理解经典知识蒸馏范式、LLM 时代的蒸馏实践（DeepSeek-R1-Distill、Qwen3 思考模式融合），以及蒸馏与 RL 训练的权衡\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5/knowledge-distillation\",\"$ref\":{\"file\":\"lecture-5/knowledge-distillation.mdx\"}},{\"$id\":\"lecture-5/capability-extensions.mdx\",\"type\":\"page\",\"name\":\"5.3 能力扩展概览\",\"description\":\"多模态后训练（VLM/LLaVA）、工具使用与智能体（函数调用/MCP）、知识编辑（参数编辑/RAG）三大能力扩展方向\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5/capability-extensions\",\"$ref\":{\"file\":\"lecture-5/capability-extensions.mdx\"}},{\"$id\":\"lecture-5/papers.mdx\",\"type\":\"page\",\"name\":\"第5课 推荐论文\",\"description\":\"GPTQ、AWQ、LLaVA、ToolACE、DeepSeek-R1 等 5 篇核心论文，涵盖量化、多模态、工具使用与蒸馏\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5/papers\",\"$ref\":{\"file\":\"lecture-5/papers.mdx\"}},{\"$id\":\"lecture-5/lab.mdx\",\"type\":\"page\",\"name\":\"第5课 上机实验\",\"description\":\"量化实验（必做）：多精度加载 Qwen3-8B 并评估压缩影响；能力扩展选做（三选一）：蒸馏分析、多模态实验、工具调用实验\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-5/lab\",\"$ref\":{\"file\":\"lecture-5/lab.mdx\"}}],\"$id\":\"lecture-5\",\"$ref\":{\"metaFile\":\"lecture-5/meta.json\"}},{\"type\":\"folder\",\"name\":\"第6课：项目报告与总结\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"lecture-6/index.mdx\",\"type\":\"page\",\"name\":\"第6课：课程项目报告与总结\",\"description\":\"课程项目报告展示、评分标准，以及后训练技术全景回顾与前沿展望\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-6\",\"$ref\":{\"file\":\"lecture-6/index.mdx\"}},{\"$id\":\"lecture-6/project-directions.mdx\",\"type\":\"page\",\"name\":\"推荐项目方向\",\"description\":\"7 个推荐的课程项目方向，涵盖数学推理、安全对齐、中文写作、代码推理、领域问答、视觉问答、工具调用智能体\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-6/project-directions\",\"$ref\":{\"file\":\"lecture-6/project-directions.mdx\"}},{\"$id\":\"lecture-6/presentation-guide.mdx\",\"type\":\"page\",\"name\":\"演示指南与评分标准\",\"description\":\"项目演示的时间安排、内容要求、评分细则，以及高质量演示的实用技巧\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-6/presentation-guide\",\"$ref\":{\"file\":\"lecture-6/presentation-guide.mdx\"}},{\"$id\":\"lecture-6/course-summary.mdx\",\"type\":\"page\",\"name\":\"课程总结与展望\",\"description\":\"后训练技术完整图谱回顾，从 SFT 到 GRPO 的完整路径，以及后训练领域的前沿研究方向\",\"icon\":\"$undefined\",\"url\":\"/docs/lecture-6/course-summary\",\"$ref\":{\"file\":\"lecture-6/course-summary.mdx\"}}],\"$id\":\"lecture-6\",\"$ref\":{\"metaFile\":\"lecture-6/meta.json\"}},{\"$id\":\"#10\",\"type\":\"separator\",\"icon\":\"$undefined\",\"name\":\"资源\"},{\"type\":\"folder\",\"name\":\"课程资源\",\"icon\":\"$undefined\",\"root\":\"$undefined\",\"defaultOpen\":\"$undefined\",\"description\":\"$undefined\",\"index\":\"$undefined\",\"children\":[{\"$id\":\"resources/setup-guide.mdx\",\"type\":\"page\",\"name\":\"环境配置指南\",\"description\":\"AutoDL 环境搭建、Colab Pro 替代方案、依赖安装、模型预下载、一键启动脚本与验证步骤\",\"icon\":\"$undefined\",\"url\":\"/docs/resources/setup-guide\",\"$ref\":{\"file\":\"resources/setup-guide.mdx\"}},{\"$id\":\"resources/gpu-cost-guide.mdx\",\"type\":\"page\",\"name\":\"GPU 配置与费用估算\",\"description\":\"各课次 GPU 配置推荐、AutoDL 费用明细、省钱技巧与替代平台\",\"icon\":\"$undefined\",\"url\":\"/docs/resources/gpu-cost-guide\",\"$ref\":{\"file\":\"resources/gpu-cost-guide.mdx\"}},{\"$id\":\"resources/references.mdx\",\"type\":\"page\",\"name\":\"完整参考文献\",\"description\":\"按课次整理的全部推荐论文、教材和在线资源\",\"icon\":\"$undefined\",\"url\":\"/docs/resources/references\",\"$ref\":{\"file\":\"resources/references.mdx\"}}],\"$id\":\"resources\",\"$ref\":{\"metaFile\":\"resources/meta.json\"}}]},\"children\":\"$L7\"}]]}],{\"children\":[[\"slug\",\"lecture-2/instruction-datasets\",\"oc\"],\"$L8\",{\"children\":[\"__PAGE__\",\"$L9\",{},null,false]},null,false]},null,false]},null,false],\"$La\",false]],\"m\":\"$undefined\",\"G\":[\"$b\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:I[64564,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"NavProvider\"]\nd:I[54196,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"Navbar\"]\ne:I[57326,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"default\"]\nf:I[70140,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SearchToggle\"]\n10:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarTrigger\"]\n11:I[54196,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"LayoutBody\"]\n12:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"Sidebar\"]\n13:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d092705"])</script><script>self.__next_f.push([1,"9867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarContentMobile\"]\n14:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarHeader\"]\n15:I[55461,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"ThemeToggle\"]\n16:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarViewport\"]\n17:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarItem\"]\n18:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarPageTree\"]\n19:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarFooter\"]\n1a:I[54196,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635"])</script><script>self.__next_f.push([1,"716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"CollapsibleControl\"]\n1b:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarContent\"]\n1c:I[79896,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"SidebarCollapseTrigger\"]\n1d:I[70140,[\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"1698\",\"static/chunks/1698-20472d0927059867.js\",\"7997\",\"static/chunks/7997-9f155fcb121a084c.js\",\"795\",\"static/chunks/795-ed3635716c096e23.js\",\"4499\",\"static/chunks/app/docs/layout-bc08591310048441.js\"],\"LargeSearchToggle\"]\n1f:I[13652,[],\"OutletBoundary\"]\n21:I[1293,[],\"AsyncMetadataOutlet\"]\n23:I[13652,[],\"ViewportBoundary\"]\n25:I[13652,[],\"MetadataBoundary\"]\n26:\"$Sreact.suspense\"\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"$Lc\",null,{\"transparentMode\":\"$undefined\",\"children\":[[\"$\",\"$Ld\",null,{\"className\":\"h-(--fd-nav-height) on-root:[--fd-nav-height:56px] md:on-root:[--fd-nav-height:0px] md:hidden\",\"children\":[[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"inline-flex items-center gap-2.5 font-semibold\",\"children\":\"LLM 后训练实践\"}],[\"$\",\"div\",null,{\"className\":\"flex-1\",\"children\":\"$undefined\"}],[\"$\",\"$Lf\",null,{\"className\":\"p-2\",\"hideIfDisabled\":true}],[\"$\",\"$L10\",null,{\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground [\u0026_svg]:size-4.5 p-2\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide\",\"children\":[[[\"$\",\"rect\",\"afitv7\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"3\",\"rx\":\"2\"}],[\"$\",\"path\",\"fh3hqa\",{\"d\":\"M9 3v18\"}]],\"$undefined\"]}]}]]}],[\"$\",\"$L11\",null,{\"className\":\"md:[\u0026_#nd-page_article]:pt-12 xl:[--fd-toc-width:286px] xl:[\u0026_#nd-page_article]:px-8 md:[--fd-sidebar-width:268px] lg:[--fd-sidebar-width:286px]\",\"children\":[[\"$\",\"$L12\",null,{\"defaultOpenLevel\":\"$undefined\",\"prefetch\":\"$undefined\",\"Mobile\":[\"$\",\"$L13\",null,{\"children\":[[\"$\",\"$L14\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex text-fd-muted-foreground items-center gap-1.5\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-1\",\"children\":[]}],null,[\"$\",\"$L15\",null,{\"className\":\"p-0\",\"mode\":\"$undefined\"}],[\"$\",\"$L10\",null,{\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground [\u0026_svg]:size-4.5 p-2\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide\",\"children\":[[[\"$\",\"rect\",\"afitv7\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"3\",\"rx\":\"2\"}],[\"$\",\"path\",\"fh3hqa\",{\"d\":\"M9 3v18\"}]],\"$undefined\"]}]}]]}],false,\"$undefined\"]}],[\"$\",\"$L16\",null,{\"children\":[[[\"$\",\"$L17\",\"0\",{\"href\":\"/docs\",\"icon\":\"$undefined\",\"external\":\"$undefined\",\"className\":\"mb-4\",\"children\":\"课程内容\"}]],[\"$\",\"$L18\",null,{\"components\":\"$undefined\"}]]}],[\"$\",\"$L19\",null,{\"className\":\"empty:hidden\",\"children\":\"$undefined\"}]]}],\"Content\":[[\"$\",\"$L1a\",null,{}],[\"$\",\"$L1b\",null,{\"children\":[[\"$\",\"$L14\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex\",\"children\":[[\"$\",\"$Le\",null,{\"href\":\"/\",\"className\":\"inline-flex text-[15px] items-center gap-2.5 font-medium me-auto\",\"children\":\"LLM 后训练实践\"}],\"$undefined\",[\"$\",\"$L1c\",null,{\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors duration-100 disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fd-ring hover:bg-fd-accent hover:text-fd-accent-foreground p-1.5 [\u0026_svg]:size-4.5 mb-auto text-fd-muted-foreground\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide\",\"children\":[[[\"$\",\"rect\",\"afitv7\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"3\",\"rx\":\"2\"}],[\"$\",\"path\",\"fh3hqa\",{\"d\":\"M9 3v18\"}]],\"$undefined\"]}]}]]}],[\"$\",\"$L1d\",null,{\"hideIfDisabled\":true}],false,\"$undefined\"]}],\"$7:props:children:1:props:children:0:props:Mobile:props:children:1\",[\"$\",\"$L19\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex text-fd-muted-foreground items-center empty:hidden\",\"children\":[false,[],[\"$\",\"$L15\",null,{\"className\":\"ms-auto p-0\",\"mode\":\"$undefined\"}]]}],\"$undefined\"]}]]}]]}],false,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"8:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n9:[\"$\",\"$1\",\"c\",{\"children\":[\"$L1e\",null,[\"$\",\"$L1f\",null,{\"children\":[\"$L20\",[\"$\",\"$L21\",null,{\"promise\":\"$@22\"}]]}]]}]\na:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L23\",null,{\"children\":\"$L24\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L25\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$26\",null,{\"fallback\":null,\"children\":\"$L27\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"28:I[32853,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"TOCProvider\"]\n29:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageTOCPopover\"]\n2a:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageTOCPopoverTrigger\"]\n2b:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageTOCPopoverContent\"]\n2c:I[32853,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"TOCScrollArea\"]\n2d:I[32853,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"TOCItems\"]\n2e:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/c"])</script><script>self.__next_f.push([1,"hunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageBreadcrumb\"]\n2f:I[54137,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"Mermaid\"]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"$L28\",null,{\"toc\":[{\"depth\":2,\"url\":\"#指令数据集的演进\",\"title\":\"指令数据集的演进\"},{\"depth\":3,\"url\":\"#发展时间线\",\"title\":\"发展时间线\"},{\"depth\":2,\"url\":\"#self-instruct指令数据合成的开创\",\"title\":\"Self-Instruct：指令数据合成的开创\"},{\"depth\":3,\"url\":\"#核心流程\",\"title\":\"核心流程\"},{\"depth\":3,\"url\":\"#准备种子任务\",\"title\":\"准备种子任务\"},{\"depth\":3,\"url\":\"#指令生成\",\"title\":\"指令生成\"},{\"depth\":3,\"url\":\"#质量过滤\",\"title\":\"质量过滤\"},{\"depth\":3,\"url\":\"#回复生成\",\"title\":\"回复生成\"},{\"depth\":3,\"url\":\"#局限性\",\"title\":\"局限性\"},{\"depth\":2,\"url\":\"#alpaca快速跟进与规模化\",\"title\":\"Alpaca：快速跟进与规模化\"},{\"depth\":2,\"url\":\"#ultrachat高质量多轮对话\",\"title\":\"UltraChat：高质量多轮对话\"},{\"depth\":3,\"url\":\"#数据构建策略\",\"title\":\"数据构建策略\"},{\"depth\":3,\"url\":\"#数据规模\",\"title\":\"数据规模\"},{\"depth\":2,\"url\":\"#magpie无种子数据合成\",\"title\":\"MAGPIE：无种子数据合成\"},{\"depth\":3,\"url\":\"#核心创新\",\"title\":\"核心创新\"},{\"depth\":3,\"url\":\"#与传统方法的对比\",\"title\":\"与传统方法的对比\"},{\"depth\":3,\"url\":\"#magpie-的多样性来源\",\"title\":\"MAGPIE 的多样性来源\"},{\"depth\":2,\"url\":\"#数据质量控制\",\"title\":\"数据质量控制\"},{\"depth\":3,\"url\":\"#去重deduplication\",\"title\":\"去重（Deduplication）\"},{\"depth\":3,\"url\":\"#难度分级difficulty-grading\",\"title\":\"难度分级（Difficulty Grading）\"},{\"depth\":3,\"url\":\"#去污染decontamination\",\"title\":\"去污染（Decontamination）\"},{\"depth\":2,\"url\":\"#数据混合策略\",\"title\":\"数据混合策略\"},{\"depth\":3,\"url\":\"#为什么需要混合\",\"title\":\"为什么需要混合\"},{\"depth\":3,\"url\":\"#tülu-3-的数据混合实践\",\"title\":\"Tülu 3 的数据混合实践\"},{\"depth\":3,\"url\":\"#混合原则\",\"title\":\"混合原则\"},{\"depth\":3,\"url\":\"#数据配比实验方法\",\"title\":\"数据配比实验方法\"},{\"depth\":2,\"url\":\"#本节小结\",\"title\":\"本节小结\"}],\"single\":\"$undefined\",\"children\":[\"$\",\"div\",null,{\"id\":\"nd-page\",\"className\":\"flex flex-1 w-full mx-auto max-w-(--fd-page-width) pt-(--fd-tocnav-height) pe-(--fd-toc-width)\",\"children\":[[\"$\",\"$L29\",null,{\"children\":[[\"$\",\"$L2a\",null,{}],[\"$\",\"$L2b\",null,{\"children\":[\"$undefined\",[\"$\",\"$L2c\",null,{\"children\":[\"$\",\"$L2d\",null,{}]}],\"$undefined\"]}]]}],[\"$\",\"article\",null,{\"children\":[[\"$\",\"$L2e\",null,{}],[[\"$\",\"h1\",null,{\"ref\":\"$undefined\",\"children\":\"2.1 指令数据集构建方法\",\"className\":\"text-[1.75em] font-semibold\"}],[\"$\",\"p\",null,{\"ref\":\"$undefined\",\"children\":\"从 Self-Instruct 到 MAGPIE 的指令数据集技术演进，数据质量控制方法，数据混合策略\",\"className\":\"mb-8 text-lg text-fd-muted-foreground\"}],[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"指令数据集的演进\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#指令数据集的演进\",\"className\":\"peer\",\"children\":\"指令数据集的演进\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"指令数据集是 SFT 的核心。过去三年，指令数据集的构建方法经历了快速演进——从手工标注到完全自动化合成。\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"发展时间线\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#发展时间线\",\"className\":\"peer\",\"children\":\"发展时间线\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],\"\\n\",[\"$\",\"$L2f\",null,{\"chart\":\"graph LR\\n  SI[\\\"\u003cb\u003eSelf-Instruct\u003c/b\u003e\u003cbr/\u003e2022.12\u003cbr/\u003e175 种子任务\\\"] --\u003e ALP[\\\"\u003cb\u003eAlpaca\u003c/b\u003e\u003cbr/\u003e2023.03\u003cbr/\u003e52K 条\\\"]\\n  ALP --\u003e UC[\\\"\u003cb\u003eUltraChat\u003c/b\u003e\u003cbr/\u003e2023.04\u003cbr/\u003e1.5M 多轮\\\"]\\n  UC --\u003e MAG[\\\"\u003cb\u003eMAGPIE\u003c/b\u003e\u003cbr/\u003e2024.06\u003cbr/\u003e无需种子\\\"]\\n  MAG --\u003e FUT[\\\"\u003cb\u003e更智能的合成\u003c/b\u003e\u003cbr/\u003e2025+\u003cbr/\u003e质量+规模\\\"]\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"self-instruct指令数据合成的开创\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#self-instruct指令数据合成的开创\",\"className\":\"peer\",\"children\":\"Self-Instruct：指令数据合成的开创\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[\"$L30\",\"$L31\"],\"$undefined\"]}]]}],\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\",\"\\n\",\"$L4e\",\"\\n\",\"$L4f\",\"\\n\",\"$L50\",\"\\n\",\"$L51\",\"\\n\",\"$L52\",\"\\n\",\"$L53\",\"\\n\",\"$L54\",\"\\n\",\"$L55\",\"\\n\",\"$L56\",\"\\n\",\"$L57\",\"\\n\",\"$L58\",\"\\n\",\"$L59\",\"\\n\",\"$L5a\",\"\\n\",\"$L5b\",\"\\n\",\"$L5c\",\"\\n\",\"$L5d\",\"\\n\",\"$L5e\",\"\\n\",\"$L5f\",\"\\n\",\"$L60\",\"\\n\",\"$L61\",\"\\n\",\"$L62\",\"\\n\",\"$L63\",\"\\n\",\"$L64\",\"\\n\",\"$L65\",\"\\n\",\"$L66\",\"\\n\",\"$L67\",\"\\n\",\"$L68\",\"\\n\",\"$L69\",\"\\n\",\"$L6a\",\"\\n\",\"$L6b\",\"\\n\",\"$L6c\",\"\\n\",\"$L6d\",\"\\n\",\"$L6e\",\"\\n\",\"$L6f\",\"\\n\",\"$L70\"],\"className\":\"prose flex-1\"}]],\"$L71\",\"$L72\"],\"className\":\"flex min-w-0 w-full flex-col gap-4 pt-8 px-4 md:px-6 md:mx-auto\"}],\"$L73\"]}]}]\n"])</script><script>self.__next_f.push([1,"74:I[50646,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"CodeBlock\"]\n76:I[50646,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"Pre\"]\nae:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageFooter\"]\naf:I[3448,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"PageTOC\"]\nb0:I[13734,[\"2569\",\"static/chunks/942c9eea-01405fae79cb4292.js\",\"4285\",\"static/chunks/4285-64b9e8f08c1e911d.js\",\"8697\",\"static/chunks/8697-8ff18c4921047cfe.js\",\"6249\",\"static/chunks/6249-ace54a767b378723.js\",\"7870\",\"static/chunks/app/docs/%5B%5B...slug%5D%5D/page-19c7862b357e04ad.js\"],\"I18nLabel\"]\n30:[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}]\n31:[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]\n32:[\"$\",\"p\",null,{\"children\":[[\"$\",\"$Le\",null,{\"href\":\"https://arxiv.org/abs/2212.10560\",\"children\":\"Self-Instruct\"}],\"（Wang 等，2023）是第一个系统性的指令数据自动生成方法。\"]}]\n"])</script><script>self.__next_f.push([1,"33:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"核心流程\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#核心流程\",\"className\":\"peer\",\"children\":\"核心流程\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"34:[\"$\",\"div\",null,{\"className\":\"fd-steps\",\"children\":[[\"$\",\"div\",null,{\"className\":\"fd-step\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"准备种子任务\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#准备种子任务\",\"className\":\"peer\",\"children\":\"准备种子任务\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],[\"$\",\"p\",null,{\"children\":[\"人工编写 \",[\"$\",\"strong\",null,{\"children\":\"175 条\"}],\"种子任务，涵盖不同类型（生成、分类、问答等）。每条包含指令、输入（可选）和输出。\"]}]]}],[\"$\",\"div\",null,{\"className\":\"fd-step\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"指令生成\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#指令生成\",\"className\":\"peer\",\"children\":\"指令生成\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],[\"$\",\"p\",null,{\"children\":[\"从种子池中随机采样 8 条指令作为 in-context 示例，提示 GPT-3 生成\",[\"$\",\"strong\",null,{\"children\":\"新指令\"}],\"。\"]}]]}],[\"$\",\"div\",null,{\"className\":\"fd-step\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"质量过滤\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#质量过滤\",\"className\":\"peer\",\"children\":\"质量过滤\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"去除与已有指令过于相似的（ROUGE-L \u003e 0.7）\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"去除以特定黑名单短语开头的（如\\\"Write a program...\\\"过于简单）\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"去除过长或过短的指令\"}],\"\\n\"]}]]}],[\"$\",\"div\",null,{\"className\":\"fd-step\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"回复生成\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#回复生成\",\"className\":\"peer\",\"children\":\"回复生成\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}],[\"$\",\"p\",null,{\"children\":\"对过滤后的指令，使用 GPT-3 生成对应回复，形成完整的（指令，回复）对。\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"35:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"局限性\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#局限性\",\"className\":\"peer\",\"children\":\"局限性\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"36:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"局限\"}],[\"$\",\"th\",null,{\"children\":\"说明\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"依赖种子数据\"}],[\"$\",\"td\",null,{\"children\":\"生成质量受 175 条种子任务的多样性限制\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"API 成本\"}],[\"$\",\"td\",null,{\"children\":\"需要大量 GPT-3 API 调用\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"质量上限\"}],[\"$\",\"td\",null,{\"children\":\"生成的数据质量受限于 GPT-3 的能力\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"多轮对话弱\"}],[\"$\",\"td\",null,{\"children\":\"主要生成单轮指令-回复对\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"37:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"38:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"alpaca快速跟进与规模化\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#alpaca快速跟进与规模化\",\"className\":\"peer\",\"children\":\"Alpaca：快速跟进与规模化\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"39:[\"$\",\"p\",null,{\"children\":[[\"$\",\"$Le\",null,{\"href\":\"https://github.com/tatsu-lab/stanford_alpaca\",\"children\":\"Stanford Alpaca\"}],\" 在 Self-Instruct 基础上做了实用改进：\"]}]\n3a:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"使用 \",[\"$\",\"strong\",null,{\"children\":\"GPT-3.5-Turbo\"}],\" 替代 GPT-3，质量更高、成本更低\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"生成了 \",[\"$\",\"strong\",null,{\"children\":\"52K 条\"}],\"指令数据\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"用这些数据微调 LLaMA-7B，总成本不到 600 美元\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"效果令人惊喜：7B 模型展现出接近 GPT-3.5 的对话能力\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"3b:[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md\",\"style\":{\"--callout-color\":\"var(--color-fd-info, var(--color-fd-muted))\"},\"children\":[[\"$\",\"div\",null,{\"role\":\"none\",\"className\":\"w-0.5 bg-(--callout-color)/50 rounded-sm\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card\",\"children\":[[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}]],\"$undefined\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-2 min-w-0 flex-1\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"text-fd-muted-foreground prose-no-margin empty:hidden\",\"children\":[\"$\",\"p\",null,{\"children\":[\"Alpaca 的意义不仅在于技术，更在于它证明了一个重要观点：\",[\"$\",\"strong\",null,{\"children\":\"高质量的指令数据可以让小模型释放出惊人的能力\"}],\"。这催生了整个开源 SFT 社区的繁荣。\"]}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"3c:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"3d:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"ultrachat高质量多轮对话\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#ultrachat高质量多轮对话\",\"className\":\"peer\",\"children\":\"UltraChat：高质量多轮对话\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"3e:[\"$\",\"p\",null,{\"children\":[[\"$\",\"$Le\",null,{\"href\":\"https://arxiv.org/abs/2305.14233\",\"children\":\"UltraChat\"}],\"（Ding 等，2023）将指令数据从单轮扩展到\",[\"$\",\"strong\",null,{\"children\":\"多轮对话\"}],\"：\"]}]\n"])</script><script>self.__next_f.push([1,"3f:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"数据构建策略\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#数据构建策略\",\"className\":\"peer\",\"children\":\"数据构建策略\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"40:[\"$\",\"p\",null,{\"children\":\"UltraChat 通过模拟真实对话场景来构建数据：\"}]\n41:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"话题种子\"}],\"：从三大类别出发——关于世界的问题、创作与写作、协助完成任务\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"多轮模拟\"}],\"：使用两个 ChatGPT 实例分别扮演用户和助手，进行多轮对话\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"质量控制\"}],\"：过滤长度异常、重复率高的对话\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"42:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"数据规模\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#数据规模\",\"className\":\"peer\",\"children\":\"数据规模\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"43:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"版本\"}],[\"$\",\"th\",null,{\"children\":\"数据量\"}],[\"$\",\"th\",null,{\"children\":\"说明\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"UltraChat\"}],[\"$\",\"td\",null,{\"children\":\"1.5M 条对话\"}],[\"$\",\"td\",null,{\"children\":\"原始版本\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"UltraChat-200K\"}],[\"$\",\"td\",null,{\"children\":\"200K 条对话\"}],[\"$\",\"td\",null,{\"children\":\"清洗版，去除低质量样本\"}]]}]]}]]}]}]\n44:[\"$\",\"p\",null,{\"children\":\"UltraChat-200K 是目前最常用的 SFT 数据集之一，也是本课程第 1 课实验使用的数据集。\"}]\n45:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"46:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"magpie无种子数据合成\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#magpie无种子数据合成\",\"className\":\"peer\",\"children\":\"MAGPIE：无种子数据合成\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"47:[\"$\",\"p\",null,{\"children\":[[\"$\",\"$Le\",null,{\"href\":\"https://arxiv.org/abs/2406.08464\",\"children\":\"MAGPIE\"}],\"（Xu 等，ICLR 2025）代表了指令数据合成的最新前沿。\"]}]\n"])</script><script>self.__next_f.push([1,"48:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"核心创新\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#核心创新\",\"className\":\"peer\",\"children\":\"核心创新\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"49:[\"$\",\"p\",null,{\"children\":[\"MAGPIE 的关键洞察：\",[\"$\",\"strong\",null,{\"children\":\"已对齐的 LLM 在看到聊天模板的用户消息前缀时，会自动补全出一条合理的指令\"}],\"。\"]}]\n75:T5c0,"])</script><script>self.__next_f.push([1,"\u003csvg viewBox=\"0 0 24 24\"\u003e\u003cpath d=\"M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z\" fill=\"currentColor\" /\u003e\u003c/svg\u003e"])</script><script>self.__next_f.push([1,"4a:[\"$\",\"$L74\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"icon\":\"$75\",\"children\":[\"$\",\"$L76\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# MAGPIE 的核心思路（伪代码）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 1. 仅输入 ChatML 模板的用户消息前缀\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"prompt \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\" \\\"\u003c|im_start|\u003euser\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"\\\\n\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 2. 让对齐模型（如 Qwen3-32B Instruct）自动补全\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"generated_instruction \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" model.generate(prompt)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 输出示例：\\\"解释黑洞是如何形成的，并举一个具体例子\\\"\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 3. 将生成的指令重新输入模型，获得回复\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"full_prompt \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"\u003c|im_start|\u003euser\"}],\"$L77\",\"$L78\",\"$L79\",\"$L7a\",\"$L7b\",\"$L7c\",\"$L7d\",\"$L7e\"]}],\"\\n\",\"$L7f\",\"\\n\",\"$L80\",\"\\n\",\"$L81\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"4b:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"与传统方法的对比\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#与传统方法的对比\",\"className\":\"peer\",\"children\":\"与传统方法的对比\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"4c:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"特性\"}],[\"$\",\"th\",null,{\"children\":\"Self-Instruct\"}],[\"$\",\"th\",null,{\"children\":\"Alpaca\"}],[\"$\",\"th\",null,{\"children\":\"MAGPIE\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"种子数据\"}],[\"$\",\"td\",null,{\"children\":\"175 条\"}],[\"$\",\"td\",null,{\"children\":\"175 条（继承）\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"无需\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"生成模型\"}],[\"$\",\"td\",null,{\"children\":\"GPT-3\"}],[\"$\",\"td\",null,{\"children\":\"GPT-3.5\"}],[\"$\",\"td\",null,{\"children\":\"任意对齐 LLM\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"多轮能力\"}],[\"$\",\"td\",null,{\"children\":\"弱\"}],[\"$\",\"td\",null,{\"children\":\"弱\"}],[\"$\",\"td\",null,{\"children\":\"支持\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"指令多样性\"}],[\"$\",\"td\",null,{\"children\":\"受种子限制\"}],[\"$\",\"td\",null,{\"children\":\"受种子限制\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"来自模型自身分布\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"成本\"}],[\"$\",\"td\",null,{\"children\":\"API 调用\"}],[\"$\",\"td\",null,{\"children\":\"API 调用\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"本地推理\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"数据质量\"}],[\"$\",\"td\",null,{\"children\":\"中等\"}],[\"$\",\"td\",null,{\"children\":\"中等\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"高\"}],\"（来自强模型）\"]}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"4d:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"magpie-的多样性来源\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#magpie-的多样性来源\",\"className\":\"peer\",\"children\":\"MAGPIE 的多样性来源\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"4e:[\"$\",\"p\",null,{\"children\":\"MAGPIE 的指令多样性来自对齐模型自身的概率分布。不同的随机种子和 temperature 设置会采样出覆盖面广泛的指令类型：\"}]\n"])</script><script>self.__next_f.push([1,"4f:[\"$\",\"$L74\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"icon\":\"\u003csvg viewBox=\\\"0 0 24 24\\\"\u003e\u003cpath d=\\\"M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z\\\" fill=\\\"currentColor\\\" /\u003e\u003c/svg\u003e\",\"children\":[\"$\",\"$L76\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"temperature=0.7 → 常规指令（问答、解释、摘要）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"temperature=1.0 → 创意指令（写作、角色扮演）\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"children\":\"temperature=1.2 → 不常见指令（冷门话题、跨领域）\"}]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"50:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"51:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"数据质量控制\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#数据质量控制\",\"className\":\"peer\",\"children\":\"数据质量控制\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"52:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"去重deduplication\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#去重deduplication\",\"className\":\"peer\",\"children\":\"去重（Deduplication）\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"53:[\"$\",\"p\",null,{\"children\":\"重复或近似重复的训练数据会导致模型过拟合到特定模式。去重方法：\"}]\n"])</script><script>self.__next_f.push([1,"54:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"方法\"}],[\"$\",\"th\",null,{\"children\":\"原理\"}],[\"$\",\"th\",null,{\"children\":\"优势\"}],[\"$\",\"th\",null,{\"children\":\"成本\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"精确去重\"}]}],[\"$\",\"td\",null,{\"children\":\"完全相同的文本\"}],[\"$\",\"td\",null,{\"children\":\"实现简单\"}],[\"$\",\"td\",null,{\"children\":\"低\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"n-gram 去重\"}]}],[\"$\",\"td\",null,{\"children\":\"Jaccard 相似度 \u003e 阈值\"}],[\"$\",\"td\",null,{\"children\":\"捕获近似重复\"}],[\"$\",\"td\",null,{\"children\":\"中\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"嵌入去重\"}]}],[\"$\",\"td\",null,{\"children\":\"向量余弦相似度 \u003e 阈值\"}],[\"$\",\"td\",null,{\"children\":\"捕获语义重复\"}],[\"$\",\"td\",null,{\"children\":\"高\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"MinHash LSH\"}]}],[\"$\",\"td\",null,{\"children\":\"近似最近邻搜索\"}],[\"$\",\"td\",null,{\"children\":\"大规模高效\"}],[\"$\",\"td\",null,{\"children\":\"中\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"82:T5c0,"])</script><script>self.__next_f.push([1,"\u003csvg viewBox=\"0 0 24 24\"\u003e\u003cpath d=\"M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z\" fill=\"currentColor\" /\u003e\u003c/svg\u003e"])</script><script>self.__next_f.push([1,"55:[\"$\",\"$L74\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"icon\":\"$82\",\"children\":[\"$\",\"$L76\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 基于 n-gram 的简单去重示例\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" collections \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" Counter\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"def\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" compute_ngram_overlap\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(text1, text2, n\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"    \\\"\\\"\\\"计算两段文本的 n-gram Jaccard 相似度\\\"\\\"\\\"\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    ngrams1 \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" set\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"zip\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"*\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"[text1.split()[i:] \"}],\"$L83\",\"$L84\",\"$L85\",\"$L86\",\"$L87\"]}],\"\\n\",\"$L88\",\"\\n\",\"$L89\",\"\\n\",\"$L8a\",\"\\n\",\"$L8b\",\"\\n\",\"$L8c\",\"\\n\",\"$L8d\",\"\\n\",\"$L8e\",\"\\n\",\"$L8f\",\"\\n\",\"$L90\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"56:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"难度分级difficulty-grading\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#难度分级difficulty-grading\",\"className\":\"peer\",\"children\":\"难度分级（Difficulty Grading）\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"57:[\"$\",\"p\",null,{\"children\":[\"并非所有难度的数据对 SFT 同等有效。研究表明应优先选择\",[\"$\",\"strong\",null,{\"children\":\"中等难度\"}],\"样本：\"]}]\n58:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"太简单的数据\"}],\"：模型已经会做，学不到新东西（如\\\"1+1=?\\\"）\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"太难的数据\"}],\"：超出模型能力范围，训练信号噪声大\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"中等难度数据\"}],\"：在模型能力边界处，学习效率最高\"]}],\"\\n\"]}]\n59:[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"IFD（Instruction-Following Difficulty）\"}],\" 指标用于评估样本难度：\"]}]\n"])</script><script>self.__next_f.push([1,"5a:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"IFD\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"x\"}],[\"$\",\"mo\",null,{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",null,{\"children\":\"y\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"children\":\"=\"}],[\"$\",\"mfrac\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"Loss\"}],[\"$\",\"mtext\",null,{\"children\":\"conditioned\"}]]}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"y\"}],[\"$\",\"mi\",null,{\"mathvariant\":\"normal\",\"children\":\"∣\"}],[\"$\",\"mi\",null,{\"children\":\"x\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mtext\",null,{\"children\":\"Loss\"}],[\"$\",\"mtext\",null,{\"children\":\"unconditional\"}]]}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"y\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}]]}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\text{IFD}(x, y) = \\\\frac{\\\\text{Loss}_{\\\\text{conditioned}}(y|x)}{\\\\text{Loss}_{\\\\text{unconditional}}(y)}\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"IFD\"}]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"children\":\"x\"}],[\"$\",\"span\",null,{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"y\"}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",null,{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"2.363em\",\"verticalAlign\":\"-0.936em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",null,{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"1.427em\"},\"children\":[[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"Loss\"}]}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord text mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"unconditional\"}]}]}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"y\"}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]]}]]}],[\"$\",\"span\",null,{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",null,{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",null,{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord text\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"Loss\"}]}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginRight\":\"0.05em\"},\"children\":[\"$L91\",\"$L92\"]}]}],\"$L93\"]}],\"$L94\"]}]}]]}],\"$L95\",\"$L96\",\"$L97\",\"$L98\",\"$L99\"]}]]}]]}],\"$L9a\"]}],\"$L9b\"]}]}],\"$L9c\"]}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"5b:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"IFD 值高：指令对回复的影响大，即模型需要指令才能生成该回复（较难）\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"IFD 值低：即使没有指令，模型也能生成类似回复（较简单）\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"5c:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"去污染decontamination\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#去污染decontamination\",\"className\":\"peer\",\"children\":\"去污染（Decontamination）\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"5d:[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md\",\"style\":{\"--callout-color\":\"var(--color-fd-error, var(--color-fd-muted))\"},\"children\":[[\"$\",\"div\",null,{\"role\":\"none\",\"className\":\"w-0.5 bg-(--callout-color)/50 rounded-sm\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card\",\"children\":[[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1uzhvr\",{\"d\":\"m15 9-6 6\"}],[\"$\",\"path\",\"z0biqf\",{\"d\":\"m9 9 6 6\"}]],\"$undefined\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-2 min-w-0 flex-1\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"text-fd-muted-foreground prose-no-margin empty:hidden\",\"children\":[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"极其重要\"}],\"：训练数据\",[\"$\",\"strong\",null,{\"children\":\"绝对不能\"}],\"包含评估基准的测试集内容。否则评估结果将毫无意义。这就是\\\"数据泄露\\\"（data contamination）问题。\"]}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"5e:[\"$\",\"p\",null,{\"children\":\"去污染步骤：\"}]\n5f:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"收集所有常用评估基准的测试集：GSM8K、MMLU、HumanEval、IFEval 等\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"对训练数据中的每条样本，检测与测试集的 n-gram 重叠\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"移除重叠度超过阈值的训练样本\"}],\"\\n\"]}]\n9d:T5c0,"])</script><script>self.__next_f.push([1,"\u003csvg viewBox=\"0 0 24 24\"\u003e\u003cpath d=\"M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z\" fill=\"currentColor\" /\u003e\u003c/svg\u003e"])</script><script>self.__next_f.push([1,"60:[\"$\",\"$L74\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"icon\":\"$9d\",\"children\":[\"$\",\"$L76\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 去污染检查示例\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"def\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" check_contamination\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(train_sample, test_samples, n\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"10\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", threshold\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.8\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"    \\\"\\\"\\\"检查训练样本是否与测试集存在 n-gram 重叠\\\"\\\"\\\"\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    train_ngrams \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" extract_ngrams(train_sample, n)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" test_sample \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" test_samples:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        test_ngrams \"}],\"$L9e\",\"$L9f\"]}],\"\\n\",\"$La0\",\"\\n\",\"$La1\",\"\\n\",\"$La2\",\"\\n\",\"$La3\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"61:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"62:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"数据混合策略\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#数据混合策略\",\"className\":\"peer\",\"children\":\"数据混合策略\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"63:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"为什么需要混合\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#为什么需要混合\",\"className\":\"peer\",\"children\":\"为什么需要混合\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"64:[\"$\",\"p\",null,{\"children\":[\"单一来源的数据会导致模型\",[\"$\",\"strong\",null,{\"children\":\"能力偏科\"}],\"：\"]}]\n65:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"只用对话数据 → 推理能力弱\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"只用代码数据 → 通用对话差\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"只用安全数据 → 过度拒绝\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"66:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"tülu-3-的数据混合实践\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#tülu-3-的数据混合实践\",\"className\":\"peer\",\"children\":\"Tülu 3 的数据混合实践\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"67:[\"$\",\"p\",null,{\"children\":\"Tülu 3 通过系统性消融实验确定了最优数据配比：\"}]\n"])</script><script>self.__next_f.push([1,"68:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"数据类别\"}],[\"$\",\"th\",null,{\"children\":\"代表数据集\"}],[\"$\",\"th\",null,{\"children\":\"大致占比\"}],[\"$\",\"th\",null,{\"children\":\"作用\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"通用对话\"}],[\"$\",\"td\",null,{\"children\":\"UltraChat, ShareGPT\"}],[\"$\",\"td\",null,{\"children\":\"~30%\"}],[\"$\",\"td\",null,{\"children\":\"基础对话能力\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"指令跟随\"}],[\"$\",\"td\",null,{\"children\":\"IFEval 训练数据\"}],[\"$\",\"td\",null,{\"children\":\"~15%\"}],[\"$\",\"td\",null,{\"children\":\"精确格式遵循\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"数学推理\"}],[\"$\",\"td\",null,{\"children\":\"GSM8K, MATH 训练集\"}],[\"$\",\"td\",null,{\"children\":\"~15%\"}],[\"$\",\"td\",null,{\"children\":\"数学推理能力\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"代码生成\"}],[\"$\",\"td\",null,{\"children\":\"Code-Feedback\"}],[\"$\",\"td\",null,{\"children\":\"~15%\"}],[\"$\",\"td\",null,{\"children\":\"编程能力\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"安全数据\"}],[\"$\",\"td\",null,{\"children\":\"安全相关指令\"}],[\"$\",\"td\",null,{\"children\":\"~10%\"}],[\"$\",\"td\",null,{\"children\":\"安全对齐\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"知识问答\"}],[\"$\",\"td\",null,{\"children\":\"FLAN, 百科类\"}],[\"$\",\"td\",null,{\"children\":\"~10%\"}],[\"$\",\"td\",null,{\"children\":\"知识广度\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"创意写作\"}],[\"$\",\"td\",null,{\"children\":\"写作类指令\"}],[\"$\",\"td\",null,{\"children\":\"~5%\"}],[\"$\",\"td\",null,{\"children\":\"创意生成\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"69:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"混合原则\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#混合原则\",\"className\":\"peer\",\"children\":\"混合原则\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"6a:[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"flex gap-2 my-4 rounded-xl border bg-fd-card p-3 ps-1 text-sm text-fd-card-foreground shadow-md\",\"style\":{\"--callout-color\":\"var(--color-fd-info, var(--color-fd-muted))\"},\"children\":[[\"$\",\"div\",null,{\"role\":\"none\",\"className\":\"w-0.5 bg-(--callout-color)/50 rounded-sm\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-5 -me-0.5 fill-(--callout-color) text-fd-card\",\"children\":[[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}]],\"$undefined\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-2 min-w-0 flex-1\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"text-fd-muted-foreground prose-no-margin empty:hidden\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"Tülu 3 的核心发现：\",[\"$\",\"strong\",null,{\"children\":\"没有一个固定的最优配比\"}],\"——最优配比取决于你希望模型擅长什么。但以下原则是通用的：\"]}],[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"确保\",[\"$\",\"strong\",null,{\"children\":\"所有目标能力\"}],\"都有代表性数据\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"薄弱能力\"}],\"可适当增加数据占比\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"安全数据不能太少（否则不安全），也不能太多（否则过度拒绝）\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"始终通过\",[\"$\",\"strong\",null,{\"children\":\"验证集实验\"}],\"确认配比效果\"]}],\"\\n\"]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"6b:[\"$\",\"h3\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"数据配比实验方法\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#数据配比实验方法\",\"className\":\"peer\",\"children\":\"数据配比实验方法\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"a4:T5c0,"])</script><script>self.__next_f.push([1,"\u003csvg viewBox=\"0 0 24 24\"\u003e\u003cpath d=\"M14.25.18l.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98l-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95l.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25l-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z\" fill=\"currentColor\" /\u003e\u003c/svg\u003e"])</script><script>self.__next_f.push([1,"6c:[\"$\",\"$L74\",null,{\"className\":\"shiki shiki-themes github-light github-dark\",\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"icon\":\"$a4\",\"children\":[\"$\",\"$L76\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 数据混合实验框架\"}]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"mix_configs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"    \\\"config_a\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": {\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"general\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.5\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"math\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.2\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"code\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.2\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"safety\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"},\"}]]}],\"\\n\",\"$La5\",\"\\n\",\"$La6\",\"\\n\",\"$La7\",\"\\n\",\"$La8\",\"\\n\",\"$La9\",\"\\n\",\"$Laa\",\"\\n\",\"$Lab\",\"\\n\",\"$Lac\",\"\\n\",\"$Lad\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"6d:[\"$\",\"hr\",null,{}]\n"])</script><script>self.__next_f.push([1,"6e:[\"$\",\"h2\",null,{\"className\":\"flex scroll-m-28 flex-row items-center gap-2\",\"id\":\"本节小结\",\"children\":[[\"$\",\"a\",null,{\"data-card\":\"\",\"href\":\"#本节小结\",\"className\":\"peer\",\"children\":\"本节小结\"}],[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-3.5 shrink-0 text-fd-muted-foreground opacity-0 transition-opacity peer-hover:opacity-100\",\"aria-label\":\"Link to section\",\"children\":[[[\"$\",\"path\",\"1cjeqo\",{\"d\":\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}],[\"$\",\"path\",\"19qd67\",{\"d\":\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"}]],\"$undefined\"]}]]}]\n"])</script><script>self.__next_f.push([1,"6f:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"方法\"}],[\"$\",\"th\",null,{\"children\":\"年份\"}],[\"$\",\"th\",null,{\"children\":\"核心思想\"}],[\"$\",\"th\",null,{\"children\":\"数据量\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Self-Instruct\"}],[\"$\",\"td\",null,{\"children\":\"2022\"}],[\"$\",\"td\",null,{\"children\":\"种子任务 + LLM 扩展\"}],[\"$\",\"td\",null,{\"children\":\"52K\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Alpaca\"}],[\"$\",\"td\",null,{\"children\":\"2023\"}],[\"$\",\"td\",null,{\"children\":\"Self-Instruct + GPT-3.5\"}],[\"$\",\"td\",null,{\"children\":\"52K\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"UltraChat\"}],[\"$\",\"td\",null,{\"children\":\"2023\"}],[\"$\",\"td\",null,{\"children\":\"双模型模拟多轮对话\"}],[\"$\",\"td\",null,{\"children\":\"1.5M → 200K（清洗）\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"MAGPIE\"}],[\"$\",\"td\",null,{\"children\":\"2024\"}],[\"$\",\"td\",null,{\"children\":\"利用对齐模型自动补全，无需种子\"}],[\"$\",\"td\",null,{\"children\":\"可无限扩展\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"70:[\"$\",\"div\",null,{\"className\":\"relative overflow-auto prose-no-margin my-6\",\"children\":[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"质量控制\"}],[\"$\",\"th\",null,{\"children\":\"方法\"}],[\"$\",\"th\",null,{\"children\":\"重要性\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"去重\"}],[\"$\",\"td\",null,{\"children\":\"n-gram / 嵌入相似度\"}],[\"$\",\"td\",null,{\"children\":\"高——避免过拟合\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"难度分级\"}],[\"$\",\"td\",null,{\"children\":\"IFD 等指标\"}],[\"$\",\"td\",null,{\"children\":\"中——提升学习效率\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"去污染\"}],[\"$\",\"td\",null,{\"children\":\"n-gram 匹配测试集\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"极高\"}],\"——保证评估有效性\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"数据混合\"}],[\"$\",\"td\",null,{\"children\":\"消融实验确定配比\"}],[\"$\",\"td\",null,{\"children\":\"高——平衡多维能力\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"71:[\"$\",\"div\",null,{\"className\":\"flex flex-row flex-wrap items-center justify-between gap-4 empty:hidden\",\"children\":[\"$undefined\",\"$undefined\"]}]\n72:[\"$\",\"$Lae\",null,{\"items\":\"$undefined\"}]\n73:[\"$\",\"$Laf\",null,{\"children\":[\"$undefined\",[\"$\",\"h3\",null,{\"className\":\"inline-flex items-center gap-1.5 text-sm text-fd-muted-foreground\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide size-4\",\"children\":[[[\"$\",\"path\",\"olowqp\",{\"d\":\"M15 18H3\"}],[\"$\",\"path\",\"16j9eg\",{\"d\":\"M17 6H3\"}],[\"$\",\"path\",\"2avoz0\",{\"d\":\"M21 12H3\"}]],\"$undefined\"]}],[\"$\",\"$Lb0\",null,{\"label\":\"toc\"}]]}],[\"$\",\"$L2c\",null,{\"children\":[\"$\",\"$L2d\",null,{}]}],\"$undefined\"]}]\n"])</script><script>self.__next_f.push([1,"77:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"\\\\n{\"}]\n78:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"generated_instruction\"}]\n79:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"}\"}]\n7a:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\u003c|im_end|\u003e\"}]\n7b:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"\\\\n\"}]\n7c:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\u003c|im_start|\u003eassistant\"}]\n7d:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"\\\\n\"}]\n7e:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"\"}]\n7f:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"response \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" model.generate(full_prompt)\"}]]}]\n80:[\"$\",\"span\",null,{\"className\":\"line\"}]\n81:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 4. 形成完整的 (指令, 回复) 对\"}]}]\n83:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"for\"}]\n84:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" i \"}]\n85:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"in\"}]\n86:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" range\"}]\n87:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(n)]))\"}]\n"])</script><script>self.__next_f.push([1,"88:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    ngrams2 \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" set\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"zip\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"*\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"[text2.split()[i:] \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" i \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" range\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(n)]))\"}]]}]\n"])</script><script>self.__next_f.push([1,"89:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    if\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" not\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams1 \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"or\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" not\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams2:\"}]]}]\n8a:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" 0.0\"}]]}]\n8b:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    intersection \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams1 \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams2\"}]]}]\n8c:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    union \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams1 \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"|\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" ngrams2\"}]]}]\n8"])</script><script>self.__next_f.push([1,"d:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(intersection) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(union)\"}]]}]\n8e:[\"$\",\"span\",null,{\"className\":\"line\"}]\n8f:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 标记相似度 \u003e 0.7 的样本对为近似重复\"}]}]\n90:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"SIMILARITY_THRESHOLD\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" 0.7\"}]]}]\n91:[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}]\n92:[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord text mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"conditioned\"}]}]}]}]\n93:[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]\n94:[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]\n95:[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}]\n96:[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"y\"}]\n97:[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"∣"])</script><script>self.__next_f.push([1,"\"}]\n98:[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"children\":\"x\"}]\n99:[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]\n9a:[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]\n9b:[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.936em\"},\"children\":[\"$\",\"span\",null,{}]}]}]\n9c:[\"$\",\"span\",null,{\"className\":\"mclose nulldelimiter\"}]\n9e:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}]\n9f:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" extract_ngrams(test_sample, n)\"}]\n"])</script><script>self.__next_f.push([1,"a0:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        overlap \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(train_ngrams \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u0026\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" test_ngrams) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" max\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(test_ngrams), \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\")\"}]]}]\n"])</script><script>self.__next_f.push([1,"a1:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        if\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" overlap \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" threshold:\"}]]}]\na2:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" True\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"  # 污染！应移除\"}]]}]\na3:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" False\"}]]}]\n"])</script><script>self.__next_f.push([1,"a5:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"    \\\"config_b\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": {\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"general\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"math\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"code\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"safety\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"},\"}]]}]\n"])</script><script>self.__next_f.push([1,"a6:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"    \\\"config_c\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": {\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"general\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.4\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"math\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.15\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"code\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.15\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#032F62\",\"--shiki-dark\":\"#9ECBFF\"},\"children\":\"\\\"safety\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"0.3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"},\"}]]}]\n"])</script><script>self.__next_f.push([1,"a7:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"}\"}]}]\na8:[\"$\",\"span\",null,{\"className\":\"line\"}]\na9:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 对每种配比：\"}]}]\naa:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 1. 按比例采样构建训练集\"}]}]\nab:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 2. 训练模型（固定其他超参数）\"}]}]\nac:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 3. 在多个基准上评估（GSM8K、HumanEval、MT-Bench、安全测试）\"}]}]\nad:[\"$\",\"span\",null,{\"className\":\"line\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"# 4. 选择综合表现最优的配比\"}]}]\n"])</script><script>self.__next_f.push([1,"24:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n20:null\n"])</script><script>self.__next_f.push([1,"22:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"2.1 指令数据集构建方法 | LLM 后训练课程\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"从 Self-Instruct 到 MAGPIE 的指令数据集技术演进，数据质量控制方法，数据混合策略\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"27:\"$22:metadata\"\n"])</script></body></html>